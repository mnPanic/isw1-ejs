

----QUIT----(13 November 2021 20:18:32) CuisUniversity-4972.image priorSource: 14896235!

----STARTUP---- (13 November 2021 20:18:33) as /Users/hernan/Documents/Cuis/5.0-64Bits/Cuis-University-Installer/CuisUniversity-4972.image!


----QUIT----(13 November 2021 20:18:33) CuisUniversity-4972.image priorSource: 18974023!

----STARTUP---- (15 November 2021 18:22:24) as /home/ignacio/Documents/Facultad/repos-isw1/isw1/vms/tus-libros-vm/CuisUniversity-4972.image!


CodePackage subclass: #ColorExtrasPackage
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Color-Extras'!

!classDefinition: #ColorExtrasPackage category: 'Color-Extras' stamp: 'Install-Color-Extras 11/15/2021 18:22:58'!
CodePackage subclass: #ColorExtrasPackage
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Color-Extras'!

ColorExtrasPackage class
	instanceVariableNames: ''!

!classDefinition: 'ColorExtrasPackage class' category: 'Color-Extras' stamp: 'Install-Color-Extras 11/15/2021 18:22:58'!
ColorExtrasPackage class
	instanceVariableNames: ''!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/isw1/vms/tus-libros-vm/Packages/Features/Color-Extras.pck.st----!

CodePackage subclass: #MorphicMisc1Package
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classDefinition: #MorphicMisc1Package category: 'Morphic-Misc1' stamp: 'Install-Morphic-Misc1 11/15/2021 18:23:00'!
CodePackage subclass: #MorphicMisc1Package
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!
!MorphicMisc1Package commentStamp: '<historical>' prior: 0!
My purpose in life is to check that any base image methods overridden have not been updated.
See #MorphMisc1Package class>>prePackageInstall!

MorphicMisc1Package class
	instanceVariableNames: ''!

!classDefinition: 'MorphicMisc1Package class' category: 'Morphic-Misc1' stamp: 'Install-Morphic-Misc1 11/15/2021 18:23:00'!
MorphicMisc1Package class
	instanceVariableNames: ''!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/isw1/vms/tus-libros-vm/Packages/Morphic/Morphic-Misc1/Morphic-Misc1.pck.st----!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/isw1/vms/tus-libros-vm/Packages/Morphic/Morphic-Widgets-Extras.pck.st----!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/2021-2c/20-TusLibros/Iteracion 4/StringsServicesServer.st----!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/isw1/vms/tus-libros-vm/Packages/System/Collections-CompactArrays.pck.st----!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/isw1/vms/tus-libros-vm/Packages/Features/Compression.pck.st----!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/isw1/vms/tus-libros-vm/Packages/Features/Sound.pck.st----!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/isw1/vms/tus-libros-vm/Packages/Features/Cryptography-DigitalSignatures.pck.st----!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/isw1/vms/tus-libros-vm/Packages/Features/Identities-UUID.pck.st----!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/isw1/vms/tus-libros-vm/Packages/System/Network-Kernel.pck.st----!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/2021-2c/20-TusLibros/Iteracion 4/WebClient.pck.st----!

----STARTUP---- (15 November 2021 18:26:54) as /home/ignacio/Documents/Facultad/repos-isw1/isw1/vms/tus-libros-vm/CuisUniversity-4972.image!


----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/isw1/vms/tus-libros-vm/Packages/System/Collections-CompactArrays.pck.st----!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/isw1/vms/tus-libros-vm/Packages/Features/Compression.pck.st----!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/isw1/vms/tus-libros-vm/Packages/Features/Sound.pck.st----!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/isw1/vms/tus-libros-vm/Packages/Features/Cryptography-DigitalSignatures.pck.st----!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/isw1/vms/tus-libros-vm/Packages/Features/Identities-UUID.pck.st----!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/isw1/vms/tus-libros-vm/Packages/System/Network-Kernel.pck.st----!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/2021-2c/20-TusLibros/Iteracion 4/WebClient.pck.st----!

CodePackage subclass: #ColorExtrasPackage
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Color-Extras'!

!classDefinition: #ColorExtrasPackage category: 'Color-Extras' stamp: 'Install-Color-Extras 11/15/2021 18:29:50'!
CodePackage subclass: #ColorExtrasPackage
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Color-Extras'!

ColorExtrasPackage class
	instanceVariableNames: ''!

!classDefinition: 'ColorExtrasPackage class' category: 'Color-Extras' stamp: 'Install-Color-Extras 11/15/2021 18:29:50'!
ColorExtrasPackage class
	instanceVariableNames: ''!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/isw1/vms/tus-libros-vm/Packages/Features/Color-Extras.pck.st----!

CodePackage subclass: #MorphicMisc1Package
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classDefinition: #MorphicMisc1Package category: 'Morphic-Misc1' stamp: 'Install-Morphic-Misc1 11/15/2021 18:29:52'!
CodePackage subclass: #MorphicMisc1Package
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!
!MorphicMisc1Package commentStamp: '<historical>' prior: 0!
My purpose in life is to check that any base image methods overridden have not been updated.
See #MorphMisc1Package class>>prePackageInstall!

MorphicMisc1Package class
	instanceVariableNames: ''!

!classDefinition: 'MorphicMisc1Package class' category: 'Morphic-Misc1' stamp: 'Install-Morphic-Misc1 11/15/2021 18:29:52'!
MorphicMisc1Package class
	instanceVariableNames: ''!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/isw1/vms/tus-libros-vm/Packages/Morphic/Morphic-Misc1/Morphic-Misc1.pck.st----!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/isw1/vms/tus-libros-vm/Packages/Morphic/Morphic-Widgets-Extras.pck.st----!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/isw1/vms/tus-libros-vm/Packages/Morphic/Morphic-Widgets-Extras.pck.st----!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/2021-2c/20-TusLibros/Iteracion 4/StringsServicesServer.st----!

----End fileIn of /home/ignacio/Documents/Facultad/repos-isw1/2021-2c/20-TusLibros/Iteracion 4/WordsClientDemo.st----!

----QUIT----(15 November 2021 18:32:19) CuisUniversity-4972.image priorSource: 18974255!

----STARTUP---- (17 November 2021 22:34:43) as /home/mnpanic/Documents/dc/ing1/cuis/cuis-tus-libros-it4/CuisUniversity-4972.image!


----End fileIn of /home/mnpanic/repos/uba/ing1-repos/isw1-ejs/20-TusLibros/it4/TusLibros.st----!
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:40:34' prior: 50974914!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer 
		addService: '/ping'
		action: [ :request |	 request send200Response: 'pumba' ].
	
	webServer
		addService: '/createCart' 
		action: [	 :request | | password user |
			[user _ request fields at: 'user'.
			password _ request fields at: 'password'.
			
			request send200Response: (WebUtils jsonEncode: (tusLibrosSystem createCartFor: user authenticatedBy: password)) ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].		
	
	webServer
		addService: '/addProductToCart' 
		action: [	 :request | 
			[ | cartId isbn quantity |
				cartId _ (request fields at: 'cartId') asNumber.
			isbn _ request fields at: 'isbn'.
			quantity _ (request fields at: 'quantity') asNumber.
			tusLibrosSystem add: quantity of: isbn to: cartId.
			request send200Response: 'OK' ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
	
	"
		- Checkout
		- ListCart
		- ListPurchases
	"
	webServer
		addService: '/listCart'
		action: [ :request | 
			[
				| cartId cartContents |
				
				cartId _ (request fields at: 'cartId') asNumber.
				cartContents _ tusLibrosSystem listCart: cartId.
				
				request send200Response: (WebUtils jsonEncode: cartContents asArray)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[
				| user password userPurchases |
				user _ request fields at: 'user'.
				password _ request fields at: 'password'.
				userPurchases _ tusLibrosSystem listPurchasesOf: user authenticatedBy: password.
				"TODO: self encondePurchasesAsJson: userPurchases"
				request send200Response: (WebUtils jsonEncode: userPurchases asArray)

			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[
				| cartId transactionId |
				
				cartId _ (request fields at: 'cartId') asNumber.
				transactionId _ tusLibrosSystem checkout: cartId charging: (testObjectFactory validCard).
				
				request send200Response: (WebUtils jsonEncode: transactionId)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:42:08' prior: 50975203!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer 
		addService: '/ping'
		action: [ :request |	 request send200Response: 'pumba' ].
	
	webServer
		addService: '/createCart' 
		action: [	 :request | | password user |
			[user _ request fields at: 'user'.
			password _ request fields at: 'password'.
			
			request send200Response: (WebUtils jsonEncode: (tusLibrosSystem createCartFor: user authenticatedBy: password)) ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].		
	
	webServer
		addService: '/addProductToCart' 
		action: [	 :request | 
			[ | cartId isbn quantity |
				cartId _ (request fields at: 'cartId') asNumber.
			isbn _ request fields at: 'isbn'.
			quantity _ (request fields at: 'quantity') asNumber.
			tusLibrosSystem add: quantity of: isbn to: cartId.
			request send200Response: 'OK' ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
	
	"
		- Checkout
		- ListCart
		- ListPurchases
	"
	webServer
		addService: '/listCart'
		action: [ :request | 
			[
				| cartId cartContents |
				
				cartId _ (request fields at: 'cartId') asNumber.
				cartContents _ tusLibrosSystem listCart: cartId.
				
				request send200Response: (WebUtils jsonEncode: cartContents asArray)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[
				| user password userPurchases |
				user _ request fields at: 'user'.
				password _ request fields at: 'password'.
				userPurchases _ tusLibrosSystem listPurchasesOf: user authenticatedBy: password.
				"TODO: self encondePurchasesAsJson: userPurchases"
				request send200Response: (WebUtils jsonEncode: userPurchases asArray)

			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[
				| cartId transactionId |
				
				cartId _ (request fields at: 'cartId') asNumber.
				transactionId _ tusLibrosSystem checkout: cartId charging: (testObjectFactory validCard).
				
				request send200Response: (WebUtils jsonEncode: transactionId)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:42:14' prior: 50975292!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer 
		addService: '/ping'
		action: [ :request |	 request send200Response: 'pumba' ].
	
	webServer
		addService: '/createCart' 
		action: [	 :request | | password user |
			[user _ request fields at: 'user'.
			password _ request fields at: 'password'.
			
			request send200Response: (WebUtils jsonEncode: (tusLibrosSystem createCartFor: user authenticatedBy: password)) ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].		
	
	webServer
		addService: '/addProductToCart' 
		action: [	 :request | 
			[ | cartId isbn quantity |
				cartId _ (request fields at: 'cartId') asNumber.
			isbn _ request fields at: 'isbn'.
			quantity _ (request fields at: 'quantity') asNumber.
			tusLibrosSystem add: quantity of: isbn to: cartId.
			request send200Response: 'OK' ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[
				| cartId cartContents |
				
				cartId _ (request fields at: 'cartId') asNumber.
				cartContents _ tusLibrosSystem listCart: cartId.
				
				request send200Response: (WebUtils jsonEncode: cartContents asArray)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[
				| user password userPurchases |
				user _ request fields at: 'user'.
				password _ request fields at: 'password'.
				userPurchases _ tusLibrosSystem listPurchasesOf: user authenticatedBy: password.
				"TODO: self encondePurchasesAsJson: userPurchases"
				request send200Response: (WebUtils jsonEncode: userPurchases asArray)

			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[
				| cartId transactionId |
				
				cartId _ (request fields at: 'cartId') asNumber.
				transactionId _ tusLibrosSystem checkout: cartId charging: (testObjectFactory validCard).
				
				request send200Response: (WebUtils jsonEncode: transactionId)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:42:49' prior: 50975381!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer 
		addService: '/ping'
		action: [ :request |	 self handlePing: request request send200Response: 'pumba' ].
	
	webServer
		addService: '/createCart' 
		action: [	 :request | | password user |
			[user _ request fields at: 'user'.
			password _ request fields at: 'password'.
			
			request send200Response: (WebUtils jsonEncode: (tusLibrosSystem createCartFor: user authenticatedBy: password)) ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].		
	
	webServer
		addService: '/addProductToCart' 
		action: [	 :request | 
			[ | cartId isbn quantity |
				cartId _ (request fields at: 'cartId') asNumber.
			isbn _ request fields at: 'isbn'.
			quantity _ (request fields at: 'quantity') asNumber.
			tusLibrosSystem add: quantity of: isbn to: cartId.
			request send200Response: 'OK' ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[
				| cartId cartContents |
				
				cartId _ (request fields at: 'cartId') asNumber.
				cartContents _ tusLibrosSystem listCart: cartId.
				
				request send200Response: (WebUtils jsonEncode: cartContents asArray)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[
				| user password userPurchases |
				user _ request fields at: 'user'.
				password _ request fields at: 'password'.
				userPurchases _ tusLibrosSystem listPurchasesOf: user authenticatedBy: password.
				"TODO: self encondePurchasesAsJson: userPurchases"
				request send200Response: (WebUtils jsonEncode: userPurchases asArray)

			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[
				| cartId transactionId |
				
				cartId _ (request fields at: 'cartId') asNumber.
				transactionId _ tusLibrosSystem checkout: cartId charging: (testObjectFactory validCard).
				
				request send200Response: (WebUtils jsonEncode: transactionId)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:42:53' prior: 50975468!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer 
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	webServer
		addService: '/createCart' 
		action: [	 :request | | password user |
			[user _ request fields at: 'user'.
			password _ request fields at: 'password'.
			
			request send200Response: (WebUtils jsonEncode: (tusLibrosSystem createCartFor: user authenticatedBy: password)) ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].		
	
	webServer
		addService: '/addProductToCart' 
		action: [	 :request | 
			[ | cartId isbn quantity |
				cartId _ (request fields at: 'cartId') asNumber.
			isbn _ request fields at: 'isbn'.
			quantity _ (request fields at: 'quantity') asNumber.
			tusLibrosSystem add: quantity of: isbn to: cartId.
			request send200Response: 'OK' ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[
				| cartId cartContents |
				
				cartId _ (request fields at: 'cartId') asNumber.
				cartContents _ tusLibrosSystem listCart: cartId.
				
				request send200Response: (WebUtils jsonEncode: cartContents asArray)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[
				| user password userPurchases |
				user _ request fields at: 'user'.
				password _ request fields at: 'password'.
				userPurchases _ tusLibrosSystem listPurchasesOf: user authenticatedBy: password.
				"TODO: self encondePurchasesAsJson: userPurchases"
				request send200Response: (WebUtils jsonEncode: userPurchases asArray)

			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[
				| cartId transactionId |
				
				cartId _ (request fields at: 'cartId') asNumber.
				transactionId _ tusLibrosSystem checkout: cartId charging: (testObjectFactory validCard).
				
				request send200Response: (WebUtils jsonEncode: transactionId)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'nil' stamp: 'MP 11/17/2021 22:43:07'!
handlePing: request

	request send200Response: 'pumba'! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:43:21' prior: 50975556!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer 
addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	webServer
		addService: '/createCart' 
		action: [	 :request | | password user |
			[user _ request fields at: 'user'.
			password _ request fields at: 'password'.
			
			request send200Response: (WebUtils jsonEncode: (tusLibrosSystem createCartFor: user authenticatedBy: password)) ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].		
	
	webServer
		addService: '/addProductToCart' 
		action: [	 :request | 
			[ | cartId isbn quantity |
				cartId _ (request fields at: 'cartId') asNumber.
			isbn _ request fields at: 'isbn'.
			quantity _ (request fields at: 'quantity') asNumber.
			tusLibrosSystem add: quantity of: isbn to: cartId.
			request send200Response: 'OK' ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[
				| cartId cartContents |
				
				cartId _ (request fields at: 'cartId') asNumber.
				cartContents _ tusLibrosSystem listCart: cartId.
				
				request send200Response: (WebUtils jsonEncode: cartContents asArray)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[
				| user password userPurchases |
				user _ request fields at: 'user'.
				password _ request fields at: 'password'.
				userPurchases _ tusLibrosSystem listPurchasesOf: user authenticatedBy: password.
				"TODO: self encondePurchasesAsJson: userPurchases"
				request send200Response: (WebUtils jsonEncode: userPurchases asArray)

			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[
				| cartId transactionId |
				
				cartId _ (request fields at: 'cartId') asNumber.
				transactionId _ tusLibrosSystem checkout: cartId charging: (testObjectFactory validCard).
				
				request send200Response: (WebUtils jsonEncode: transactionId)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:43:22' prior: 50975648!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	webServer
		addService: '/createCart' 
		action: [	 :request | | password user |
			[user _ request fields at: 'user'.
			password _ request fields at: 'password'.
			
			request send200Response: (WebUtils jsonEncode: (tusLibrosSystem createCartFor: user authenticatedBy: password)) ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].		
	
	webServer
		addService: '/addProductToCart' 
		action: [	 :request | 
			[ | cartId isbn quantity |
				cartId _ (request fields at: 'cartId') asNumber.
			isbn _ request fields at: 'isbn'.
			quantity _ (request fields at: 'quantity') asNumber.
			tusLibrosSystem add: quantity of: isbn to: cartId.
			request send200Response: 'OK' ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[
				| cartId cartContents |
				
				cartId _ (request fields at: 'cartId') asNumber.
				cartContents _ tusLibrosSystem listCart: cartId.
				
				request send200Response: (WebUtils jsonEncode: cartContents asArray)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[
				| user password userPurchases |
				user _ request fields at: 'user'.
				password _ request fields at: 'password'.
				userPurchases _ tusLibrosSystem listPurchasesOf: user authenticatedBy: password.
				"TODO: self encondePurchasesAsJson: userPurchases"
				request send200Response: (WebUtils jsonEncode: userPurchases asArray)

			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[
				| cartId transactionId |
				
				cartId _ (request fields at: 'cartId') asNumber.
				transactionId _ tusLibrosSystem checkout: cartId charging: (testObjectFactory validCard).
				
				request send200Response: (WebUtils jsonEncode: transactionId)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:43:27' prior: 50975735!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	webServer
		addService: '/createCart' 
		action: [	 :request | | password user |
			[user _ request fields at: 'user'.
			password _ request fields at: 'password'.
			
			request send200Response: (WebUtils jsonEncode: (tusLibrosSystem createCartFor: user authenticatedBy: password)) ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].		
	
	webServer
		addService: '/addProductToCart' 
		action: [	 :request | 
			[ | cartId isbn quantity |
				cartId _ (request fields at: 'cartId') asNumber.
			isbn _ request fields at: 'isbn'.
			quantity _ (request fields at: 'quantity') asNumber.
			tusLibrosSystem add: quantity of: isbn to: cartId.
			request send200Response: 'OK' ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[
				| cartId cartContents |
				
				cartId _ (request fields at: 'cartId') asNumber.
				cartContents _ tusLibrosSystem listCart: cartId.
				
				request send200Response: (WebUtils jsonEncode: cartContents asArray)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[
				| user password userPurchases |
				user _ request fields at: 'user'.
				password _ request fields at: 'password'.
				userPurchases _ tusLibrosSystem listPurchasesOf: user authenticatedBy: password.
				"TODO: self encondePurchasesAsJson: userPurchases"
				request send200Response: (WebUtils jsonEncode: userPurchases asArray)

			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[
				| cartId transactionId |
				
				cartId _ (request fields at: 'cartId') asNumber.
				transactionId _ tusLibrosSystem checkout: cartId charging: (testObjectFactory validCard).
				
				request send200Response: (WebUtils jsonEncode: transactionId)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:43:46' prior: 50975822!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	webServer
		addService: '/createCart' 
		action: [	 :request | | password user |
			[ user _ request fields at: 'user'.
			password _ request fields at: 'password'.
			
			request send200Response: (WebUtils jsonEncode: (tusLibrosSystem createCartFor: user authenticatedBy: password)) ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].		
	
	webServer
		addService: '/addProductToCart' 
		action: [	 :request | 
			[ | cartId isbn quantity |
				cartId _ (request fields at: 'cartId') asNumber.
			isbn _ request fields at: 'isbn'.
			quantity _ (request fields at: 'quantity') asNumber.
			tusLibrosSystem add: quantity of: isbn to: cartId.
			request send200Response: 'OK' ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[
				| cartId cartContents |
				
				cartId _ (request fields at: 'cartId') asNumber.
				cartContents _ tusLibrosSystem listCart: cartId.
				
				request send200Response: (WebUtils jsonEncode: cartContents asArray)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[
				| user password userPurchases |
				user _ request fields at: 'user'.
				password _ request fields at: 'password'.
				userPurchases _ tusLibrosSystem listPurchasesOf: user authenticatedBy: password.
				"TODO: self encondePurchasesAsJson: userPurchases"
				request send200Response: (WebUtils jsonEncode: userPurchases asArray)

			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[
				| cartId transactionId |
				
				cartId _ (request fields at: 'cartId') asNumber.
				transactionId _ tusLibrosSystem checkout: cartId charging: (testObjectFactory validCard).
				
				request send200Response: (WebUtils jsonEncode: transactionId)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:44:04' prior: 50975909!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	webServer
		addService: '/createCart' 
		action: [	 :request |
			[ 
				 | password user |
				user _ request fields at: 'user'.
			password _ request fields at: 'password'.
			
			request send200Response: (WebUtils jsonEncode: (tusLibrosSystem createCartFor: user authenticatedBy: password)) ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].		
	
	webServer
		addService: '/addProductToCart' 
		action: [	 :request | 
			[ | cartId isbn quantity |
				cartId _ (request fields at: 'cartId') asNumber.
			isbn _ request fields at: 'isbn'.
			quantity _ (request fields at: 'quantity') asNumber.
			tusLibrosSystem add: quantity of: isbn to: cartId.
			request send200Response: 'OK' ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[
				| cartId cartContents |
				
				cartId _ (request fields at: 'cartId') asNumber.
				cartContents _ tusLibrosSystem listCart: cartId.
				
				request send200Response: (WebUtils jsonEncode: cartContents asArray)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[
				| user password userPurchases |
				user _ request fields at: 'user'.
				password _ request fields at: 'password'.
				userPurchases _ tusLibrosSystem listPurchasesOf: user authenticatedBy: password.
				"TODO: self encondePurchasesAsJson: userPurchases"
				request send200Response: (WebUtils jsonEncode: userPurchases asArray)

			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[
				| cartId transactionId |
				
				cartId _ (request fields at: 'cartId') asNumber.
				transactionId _ tusLibrosSystem checkout: cartId charging: (testObjectFactory validCard).
				
				request send200Response: (WebUtils jsonEncode: transactionId)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:44:22' prior: 50975996!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	webServer
		addService: '/createCart' 
		action: [	 :request |
			[ self handleCreateCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].		
	
	webServer
		addService: '/addProductToCart' 
		action: [	 :request | 
			[ | cartId isbn quantity |
				cartId _ (request fields at: 'cartId') asNumber.
			isbn _ request fields at: 'isbn'.
			quantity _ (request fields at: 'quantity') asNumber.
			tusLibrosSystem add: quantity of: isbn to: cartId.
			request send200Response: 'OK' ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[
				| cartId cartContents |
				
				cartId _ (request fields at: 'cartId') asNumber.
				cartContents _ tusLibrosSystem listCart: cartId.
				
				request send200Response: (WebUtils jsonEncode: cartContents asArray)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[
				| user password userPurchases |
				user _ request fields at: 'user'.
				password _ request fields at: 'password'.
				userPurchases _ tusLibrosSystem listPurchasesOf: user authenticatedBy: password.
				"TODO: self encondePurchasesAsJson: userPurchases"
				request send200Response: (WebUtils jsonEncode: userPurchases asArray)

			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[
				| cartId transactionId |
				
				cartId _ (request fields at: 'cartId') asNumber.
				transactionId _ tusLibrosSystem checkout: cartId charging: (testObjectFactory validCard).
				
				request send200Response: (WebUtils jsonEncode: transactionId)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:44:47'!
handleCreateCart: request

	 | password user |
				user _ request fields at: 'user'.
			password _ request fields at: 'password'.
			
			request send200Response: (WebUtils jsonEncode: (tusLibrosSystem createCartFor: user authenticatedBy: password))! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:44:48' prior: 50976164!
handleCreateCart: request

	 | password user |
			user _ request fields at: 'user'.
			password _ request fields at: 'password'.
			
			request send200Response: (WebUtils jsonEncode: (tusLibrosSystem createCartFor: user authenticatedBy: password))! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:44:51' prior: 50976176!
handleCreateCart: request

	 | password user |
	user _ request fields at: 'user'.
	password _ request fields at: 'password'.
	
	request send200Response: (WebUtils jsonEncode: (tusLibrosSystem createCartFor: user authenticatedBy: password))! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:45:36' prior: 50976083!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	webServer
		addService: '/createCart' 
		action: [	 :request |
			[ self handleCreateCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].		
	
	webServer
		addService: '/addProductToCart' 
		action: [	 :request | 
			[ self handleAddProductToCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[
				| cartId cartContents |
				
				cartId _ (request fields at: 'cartId') asNumber.
				cartContents _ tusLibrosSystem listCart: cartId.
				
				request send200Response: (WebUtils jsonEncode: cartContents asArray)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[
				| user password userPurchases |
				user _ request fields at: 'user'.
				password _ request fields at: 'password'.
				userPurchases _ tusLibrosSystem listPurchasesOf: user authenticatedBy: password.
				"TODO: self encondePurchasesAsJson: userPurchases"
				request send200Response: (WebUtils jsonEncode: userPurchases asArray)

			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[
				| cartId transactionId |
				
				cartId _ (request fields at: 'cartId') asNumber.
				transactionId _ tusLibrosSystem checkout: cartId charging: (testObjectFactory validCard).
				
				request send200Response: (WebUtils jsonEncode: transactionId)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:45:50'!
handleAddProductToCart: request
	| cartId isbn quantity |
	cartId _ (request fields at: 'cartId') asNumber.
	isbn _ request fields at: 'isbn'.
	quantity _ (request fields at: 'quantity') asNumber.
	tusLibrosSystem add: quantity of: isbn to: cartId.
	request send200Response: 'OK'! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:45:53' prior: 50976273!
handleAddProductToCart: request

	| cartId isbn quantity |
	cartId _ (request fields at: 'cartId') asNumber.
	isbn _ request fields at: 'isbn'.
	quantity _ (request fields at: 'quantity') asNumber.
	tusLibrosSystem add: quantity of: isbn to: cartId.
	request send200Response: 'OK'! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:45:55' prior: 50976286!
handleAddProductToCart: request

	| cartId isbn quantity |
	
	cartId _ (request fields at: 'cartId') asNumber.
	isbn _ request fields at: 'isbn'.
	quantity _ (request fields at: 'quantity') asNumber.
	tusLibrosSystem add: quantity of: isbn to: cartId.
	request send200Response: 'OK'! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:45:56' prior: 50976299!
handleAddProductToCart: request

	| cartId isbn quantity |

	cartId _ (request fields at: 'cartId') asNumber.
	isbn _ request fields at: 'isbn'.
	quantity _ (request fields at: 'quantity') asNumber.
	tusLibrosSystem add: quantity of: isbn to: cartId.
	request send200Response: 'OK'! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:45:57' prior: 50976312!
handleAddProductToCart: request

	| cartId isbn quantity |

	cartId _ (request fields at: 'cartId') asNumber.
	isbn _ request fields at: 'isbn'.
	quantity _ (request fields at: 'quantity') asNumber.

	tusLibrosSystem add: quantity of: isbn to: cartId.
	request send200Response: 'OK'! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:46:04' prior: 50976325!
handleAddProductToCart: request

	| cartId isbn quantity |

	cartId _ (request fields at: 'cartId') asNumber.
	isbn _ request fields at: 'isbn'.
	quantity _ (request fields at: 'quantity') asNumber.

	tusLibrosSystem add: quantity of: isbn to: cartId.

	request send200Response: 'OK'! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:46:18' prior: 50976199!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	webServer
		addService: '/createCart' 
		action: [	 :request |
			[ self handleCreateCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].		
	
	webServer
		addService: '/addProductToCart' 
		action: [	 :request | 
			[ self handleAddProductToCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[
				
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[
				| user password userPurchases |
				user _ request fields at: 'user'.
				password _ request fields at: 'password'.
				userPurchases _ tusLibrosSystem listPurchasesOf: user authenticatedBy: password.
				"TODO: self encondePurchasesAsJson: userPurchases"
				request send200Response: (WebUtils jsonEncode: userPurchases asArray)

			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[
				| cartId transactionId |
				
				cartId _ (request fields at: 'cartId') asNumber.
				transactionId _ tusLibrosSystem checkout: cartId charging: (testObjectFactory validCard).
				
				request send200Response: (WebUtils jsonEncode: transactionId)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:46:24' prior: 50976351!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	webServer
		addService: '/createCart' 
		action: [	 :request |
			[ self handleCreateCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].		
	
	webServer
		addService: '/addProductToCart' 
		action: [	 :request | 
			[ self handleAddProductToCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[
				self handleListCart: request.
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[
				| user password userPurchases |
				user _ request fields at: 'user'.
				password _ request fields at: 'password'.
				userPurchases _ tusLibrosSystem listPurchasesOf: user authenticatedBy: password.
				"TODO: self encondePurchasesAsJson: userPurchases"
				request send200Response: (WebUtils jsonEncode: userPurchases asArray)

			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[
				| cartId transactionId |
				
				cartId _ (request fields at: 'cartId') asNumber.
				transactionId _ tusLibrosSystem checkout: cartId charging: (testObjectFactory validCard).
				
				request send200Response: (WebUtils jsonEncode: transactionId)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:46:35'!
handleListCart: request

	| cartId cartContents |
				
	cartId _ (request fields at: 'cartId') asNumber.
	cartContents _ tusLibrosSystem listCart: cartId.
	
	request send200Response: (WebUtils jsonEncode: cartContents asArray)! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:46:55' prior: 50976419!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	webServer
		addService: '/createCart' 
		action: [	 :request |
			[ self handleCreateCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].		
	
	webServer
		addService: '/addProductToCart' 
		action: [	 :request | 
			[ self handleAddProductToCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[
				self handleListCart: request.
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[
				self handleListPurchases: request.

			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[
				| cartId transactionId |
				
				cartId _ (request fields at: 'cartId') asNumber.
				transactionId _ tusLibrosSystem checkout: cartId charging: (testObjectFactory validCard).
				
				request send200Response: (WebUtils jsonEncode: transactionId)
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:47:07'!
handleListPurchases: request

	| user password userPurchases |
	user _ request fields at: 'user'.
	password _ request fields at: 'password'.

	userPurchases _ tusLibrosSystem listPurchasesOf: user authenticatedBy: password.

	"TODO: self encondePurchasesAsJson: userPurchases"
	request send200Response: (WebUtils jsonEncode: userPurchases asArray)! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:47:20' prior: 50976498!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	webServer
		addService: '/createCart' 
		action: [	 :request |
			[ self handleCreateCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].		
	
	webServer
		addService: '/addProductToCart' 
		action: [	 :request | 
			[ self handleAddProductToCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[
				self handleListCart: request.
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[
				self handleListPurchases: request.

			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[
				self handleCheckout: request.
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:48:07'!
handleCheckout: request

	| cartId transactionId |
				
	cartId _ (request fields at: 'cartId') asNumber.
	transactionId _ tusLibrosSystem checkout: cartId charging: (nil validCard). "TODO: pedir la tarjeta"	
	request send200Response: (WebUtils jsonEncode: transactionId)! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:48:48' prior: 50976572!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	webServer
		addService: '/createCart' 
		action: [	 :request |
			[ self handleCreateCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].		
	
	webServer
		addService: '/addProductToCart' 
		action: [	 :request | 
			[ self handleAddProductToCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[
				self handleListCart: request.
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[
				self handleListPurchases: request.

			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[ self handleCheckout: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:48:55' prior: 50976636!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	webServer
		addService: '/createCart' 
		action: [	 :request |
			[ self handleCreateCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].		
	
	webServer
		addService: '/addProductToCart' 
		action: [	 :request | 
			[ self handleAddProductToCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[
				self handleListCart: request.
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[
				self handleListPurchases: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[ self handleCheckout: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:48:57' prior: 50976688!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	webServer
		addService: '/createCart' 
		action: [	 :request |
			[ self handleCreateCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].		
	
	webServer
		addService: '/addProductToCart' 
		action: [	 :request | 
			[ self handleAddProductToCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[
				self handleListCart: request.
			]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[ self handleListPurchases: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[ self handleCheckout: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:49:01' prior: 50976740!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	webServer
		addService: '/createCart' 
		action: [	 :request |
			[ self handleCreateCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].		
	
	webServer
		addService: '/addProductToCart' 
		action: [	 :request | 
			[ self handleAddProductToCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[
				self handleListCart: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[ self handleListPurchases: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[ self handleCheckout: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:49:04' prior: 50976792!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	webServer
		addService: '/createCart' 
		action: [	 :request |
			[ self handleCreateCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].		
	
	webServer
		addService: '/addProductToCart' 
		action: [	 :request | 
			[ self handleAddProductToCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[ self handleListCart: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[ self handleListPurchases: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[ self handleCheckout: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:50:06' prior: 50976844!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self addService: '/createCart' withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	webServer
		addService: '/createCart' 
		action: [	 :request |
			[ self handleCreateCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].		
	
	webServer
		addService: '/addProductToCart' 
		action: [	 :request | 
			[ self handleAddProductToCart: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[ self handleListCart: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[ self handleListPurchases: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[ self handleCheckout: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:50:53'!
addService: serviceName withErrorSafeAction: action

	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:51:18' prior: 50976951!
addService: serviceName withErrorSafeAction: action

	webServer
		addService: serviceName 
		action: [	 :request |
			[ action value: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].

	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:51:26' prior: 50976957!
addService: serviceName withErrorSafeAction: action

	webServer
		addService: serviceName 
		action: [	 :request |
			[ action value: request ] 
			on: Error
			do:[ :error | request  send500Response: error messageText ].
		].
! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:51:29' prior: 50976968!
addService: serviceName withErrorSafeAction: action

	webServer
		addService: serviceName 
		action: [	 :request |
			[ action value: request ] 
			on: Error
			do: [ :error | request  send500Response: error messageText ].
		].
! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:52:17' prior: 50976896!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self addService: '/createCart' withErrorSafeAction: [ :request | self handleCreateCart: request ].
	self addService: '/addProductToCart' withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[ self handleListCart: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[ self handleListPurchases: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[ self handleCheckout: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:52:34' prior: 50976990!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self addService: '/createCart' withErrorSafeAction: [ :request | self handleCreateCart: request ].
	self addService: '/addProductToCart' withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[ self handleListCart: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[ self handleListPurchases: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[ self handleCheckout: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:52:38' prior: 50977037!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self 
		addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	self addService: '/addProductToCart' withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[ self handleListCart: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[ self handleListPurchases: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[ self handleCheckout: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:52:40' prior: 50977084!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self 
		addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self addService: '/addProductToCart' withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[ self handleListCart: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[ self handleListPurchases: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[ self handleCheckout: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:52:42' prior: 50977131!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self 
		addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self 
		addService: '/addProductToCart' withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[ self handleListCart: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[ self handleListPurchases: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[ self handleCheckout: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:52:44' prior: 50977178!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self 
		addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self 
		addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	
	webServer
		addService: '/listCart'
		action: [ :request | 
			[ self handleListCart: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[ self handleListPurchases: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[ self handleCheckout: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:53:09' prior: 50977225!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self 
		addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self 
		addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	
	self
		addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].
			
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[ self handleListPurchases: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[ self handleCheckout: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:53:12' prior: 50977272!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self 
		addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self 
		addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self
		addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].
			
	
	webServer
		addService: '/listPurchases'
		action: [ :request |
			[ self handleListPurchases: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		].
	
	webServer
		addService: '/checkout'
		action: [ :request |
			[ self handleCheckout: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:53:35' prior: 50977317!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self 
		addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self 
		addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self
		addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].
			
	
	self
		addService: '/listPurchases'
		withErrorSafeAction: [ :request | self handleListPurchases: request ].
	webServer
		addService: '/checkout'
		action: [ :request |
			[ self handleCheckout: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:53:37' prior: 50977362!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self 
		addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self 
		addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self
		addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].
		
	self
		addService: '/listPurchases'
		withErrorSafeAction: [ :request | self handleListPurchases: request ].
	webServer
		addService: '/checkout'
		action: [ :request |
			[ self handleCheckout: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:53:39' prior: 50977404!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self 
		addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self 
		addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self
		addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].

	self
		addService: '/listPurchases'
		withErrorSafeAction: [ :request | self handleListPurchases: request ].
	webServer
		addService: '/checkout'
		action: [ :request |
			[ self handleCheckout: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:53:49' prior: 50977446!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self 
		addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self 
		addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self
		addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].

	self
		addService: '/listPurchases'
		withErrorSafeAction: [ :request | self handleListPurchases: request ].

	webServer
		addService: '/checkout'
		action: [ :request |
			[ self handleCheckout: request. ]
			on: Error
			do: [ :error | request send500Response: error messageText ]
		]
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:54:16' prior: 50977488!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self 
		addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self 
		addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self
		addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].

	self
		addService: '/listPurchases'
		withErrorSafeAction: [ :request | self handleListPurchases: request ].

	self
		addService: '/checkout'
		withErrorSafeAction: [ :request | self handleCheckout: request. ].
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:54:26' prior: 50977530!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self 
		addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self
		addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].

	self
		addService: '/listPurchases'
		withErrorSafeAction: [ :request | self handleListPurchases: request ].

	self
		addService: '/checkout'
		withErrorSafeAction: [ :request | self handleCheckout: request. ].
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:54:30' prior: 50977570!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self
		addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].

	self
		addService: '/listPurchases'
		withErrorSafeAction: [ :request | self handleListPurchases: request ].

	self
		addService: '/checkout'
		withErrorSafeAction: [ :request | self handleCheckout: request. ].
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:54:35' prior: 50977609!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].

	self
		addService: '/listPurchases'
		withErrorSafeAction: [ :request | self handleListPurchases: request ].

	self
		addService: '/checkout'
		withErrorSafeAction: [ :request | self handleCheckout: request. ].
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:54:37' prior: 50977648!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].

	self addService: '/listPurchases'
		withErrorSafeAction: [ :request | self handleListPurchases: request ].

	self
		addService: '/checkout'
		withErrorSafeAction: [ :request | self handleCheckout: request. ].
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:54:39' prior: 50977687!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer
		addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].

	self addService: '/listPurchases'
		withErrorSafeAction: [ :request | self handleListPurchases: request ].

	self addService: '/checkout'
		withErrorSafeAction: [ :request | self handleCheckout: request. ].
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:54:42' prior: 50977726!
initializeOn: aPortNumber

	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].

	self addService: '/listPurchases'
		withErrorSafeAction: [ :request | self handleListPurchases: request ].

	self addService: '/checkout'
		withErrorSafeAction: [ :request | self handleCheckout: request. ].
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:54:56' prior: 50976624!
handleCheckout: request

	| cartId transactionId |
				
	cartId _ (request fields at: 'cartId') asNumber.
	transactionId _ tusLibrosSystem checkout: cartId charging: (nil validCard). "TODO: pedir la tarjeta"	

	request send200Response: (WebUtils jsonEncode: transactionId)! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:55:59' prior: 50977804!
handleCheckout: request

	| cartId transactionId cardNumber cvv holderName |
				
	cartId _ (request fields at: 'cartId') asNumber.
	cardNumber _ (request fields at: 'cardNumber' ).
	cvv _ (request fields at: 'cvv').
	holderName _ (request fields at: 'holderName' ).
	
	transactionId _ tusLibrosSystem checkout: cartId charging: (nil validCard). "TODO: pedir la tarjeta"	

	request send200Response: (WebUtils jsonEncode: transactionId)! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:57:28' prior: 50977816!
handleCheckout: request

	| cartId transactionId |
				
	cartId _ (request fields at: 'cartId') asNumber.
	
	transactionId _ tusLibrosSystem checkout: cartId charging: (Card withNumber: 'xx' expiringOn:nil) . "TODO: pedir la tarjeta"	

	request send200Response: (WebUtils jsonEncode: transactionId)! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:58:50' prior: 50977833!
handleCheckout: request

	| cartId transactionId |
				
	cartId _ (request fields at: 'cartId') asNumber.
	
	transactionId _ tusLibrosSystem checkout: cartId charging: (Card withNumber: '4509790000001234' expiringAt: September / 2022) . "TODO: pedir la tarjeta"	

	request send200Response: (WebUtils jsonEncode: transactionId)! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 22:58:57' prior: 50977846!
handleCheckout: request

	| cartId transactionId |

	cartId _ (request fields at: 'cartId') asNumber.
	
	transactionId _ tusLibrosSystem checkout: cartId charging: (Card withNumber: '4509790000001234' expiringAt: September / 2022) . "TODO: pedir la tarjeta"	

	request send200Response: (WebUtils jsonEncode: transactionId)! !

TusLibrosRestApiXXX cleanUpAndListenOn: 8080.!
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:04:23' prior: 50977860!
handleCheckout: request

	| cartId transactionId |

	self halt.

	cartId _ (request fields at: 'cartId') asNumber.
	
	transactionId _ tusLibrosSystem checkout: cartId charging: (Card withNumber: '4509790000001234' expiringAt: September / 2022) . "TODO: pedir la tarjeta"	

	request send200Response: (WebUtils jsonEncode: transactionId)! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:05:19' prior: 50977875!
handleCheckout: request

	| cartId transactionId hardcodedCard |

	self halt.

	cartId _ (request fields at: 'cartId') asNumber.
	
	hardcodedCard _ (Card withNumber: '4509790000001234' expiringAt: September / 2022).
	transactionId _ tusLibrosSystem checkout: cartId charging: hardcodedCard . "TODO: pedir la tarjeta"	

	request send200Response: (WebUtils jsonEncode: transactionId)! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:05:27' prior: 50977889!
handleCheckout: request

	| cartId transactionId hardcodedCard |

	self halt.

	cartId _ (request fields at: 'cartId') asNumber.
	
	 "TODO: pedir la tarjeta"	
	hardcodedCard _ (Card withNumber: '4509790000001234' expiringAt: September / 2022).
	transactionId _ tusLibrosSystem checkout: cartId charging: hardcodedCard.

	request send200Response: (WebUtils jsonEncode: transactionId)! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:06:00' prior: 50977905!
handleCheckout: request

	| cartId transactionId hardcodedCard |

	self halt.

	cartId _ (request fields at: 'cartId') asNumber.
	
	 "TODO: pedir la tarjeta"	
	hardcodedCard _ (Card withNumber: '4509790000001234' expiringAt: September of: 2022).
	transactionId _ tusLibrosSystem checkout: cartId charging: hardcodedCard.

	request send200Response: (WebUtils jsonEncode: transactionId)! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:06:04' prior: 50977921!
handleCheckout: request

	| cartId transactionId hardcodedCard |

	self halt.

	cartId _ (request fields at: 'cartId') asNumber.
	
	 "TODO: pedir la tarjeta"	
	hardcodedCard _ (Card withNumber: '4509790000001234' expiringAt: (September of: 2022)).
	transactionId _ tusLibrosSystem checkout: cartId charging: hardcodedCard.

	request send200Response: (WebUtils jsonEncode: transactionId)! !

----SNAPSHOT----(17 November 2021 23:06:19) CuisUniversity-4972.image priorSource: 20541226!

TusLibrosClientWindow open.!

!classDefinition: #TusLibrosClientWindowModel category: 'TusLibros' stamp: 'MP 11/17/2021 23:13:14'!
Object subclass: #TusLibrosClientWindowModel
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:13:10' prior: 50973584!
initializeWith: aTitle

	self setLabel: aTitle.
	self model: (TusLibrosClientWindowModel new).
	self openInWorld.! !
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:15:19' prior: 50977964!
initializeWith: aTitle

	self setLabel: aTitle.
	self model: (TusLibrosClientWindowModel new).
	self buildMorphicWindow.
	self openInWorld.! !
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:15:28'!
buildMorphicWindow

	! !
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:17:02' prior: 50977979!
buildMorphicWindow

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0;
		addMorph: self build1stRow.

	! !
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:17:11' prior: 50977984!
buildMorphicWindow

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0;
		addMorph: self build1stRow.

	! !
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:17:24' prior: 50977992!
buildMorphicWindow

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0; "metodo para declaratividad"
		addMorph: self build1stRow.

	! !
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:17:32' prior: 50978000!
buildMorphicWindow

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0; "TODO: metodo para declaratividad"
		addMorph: self build1stRow.

	! !
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:22:51'!
build1stRow! !
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:25:30' prior: 50978017!
build1stRow	

	
	^LayoutMorph newRow
! !

!methodRemoval: TusLibrosClientWindow #build1stRow stamp: 'MP 11/17/2021 23:25:36'!
build1stRow	

	
	^LayoutMorph newRow
!
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:25:47' prior: 50978009!
buildMorphicWindow

	| loginButtonMorph |
	loginButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #loginRequest
		label: 'Login'.

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0; "TODO: metodo para declaratividad"
		addMorph: loginButtonMorph.

	! !
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:26:04' prior: 50978030!
buildMorphicWindow

	| loginButtonMorph |
	loginButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #loginRequest
		label: 'Login'.

	self layoutMorph
		beRow;
		separation: 15;
		axisEdgeWeight: 0; "TODO: metodo para declaratividad"
		addMorph: loginButtonMorph.

	! !

TusLibrosClientWindow open.!
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:28:44' prior: 50978043!
buildMorphicWindow

	| loginButtonMorph |
	loginButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #loginRequest
		label: 'Login'.

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0; "TODO: metodo para declaratividad"
		addMorph: loginButtonMorph.

	! !

TusLibrosClientWindow open.!
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:30:13' prior: 50978057!
buildMorphicWindow

	| loginButtonMorph userRowLayoutMorph |
	loginButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #loginRequest
		label: 'Login'.
	
	userRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Username');
		yourself.

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0; "TODO: metodo para declaratividad"
		addMorph: loginButtonMorph.

	! !
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:31:01' prior: 50978071!
buildMorphicWindow

	| loginButtonMorph userRowLayoutMorph passwordRowLayoutMorph |
	loginButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #loginRequest
		label: 'Login'.
	
	userRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Username');
		yourself.
	
	passwordRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Password');
		yourself.

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0; "TODO: metodo para declaratividad"
		addMorph: userRowLayoutMorph;
		addMorph: passwordRowLayoutMorph;
		addMorph: loginButtonMorph.

	! !

TusLibrosClientWindow open.!
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:31:22' prior: 50978088!
buildMorphicWindow

	| loginButtonMorph userRowLayoutMorph passwordRowLayoutMorph |
	loginButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #loginRequest
		label: 'Login'.
	
	userRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Username');
		yourself.
	
	passwordRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Password');
		axisEdgeWeight: 0.5;
		yourself.

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0; "TODO: metodo para declaratividad"
		addMorph: userRowLayoutMorph;
		addMorph: passwordRowLayoutMorph;
		addMorph: loginButtonMorph.

	! !
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:31:25' prior: 50978112!
buildMorphicWindow

	| loginButtonMorph userRowLayoutMorph passwordRowLayoutMorph |
	loginButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #loginRequest
		label: 'Login'.
	
	userRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Username');
		axisEdgeWeight: 0.5;
		yourself.
	
	passwordRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Password');
		axisEdgeWeight: 0.5;
		yourself.

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0; "TODO: metodo para declaratividad"
		addMorph: userRowLayoutMorph;
		addMorph: passwordRowLayoutMorph;
		addMorph: loginButtonMorph.

	! !

TusLibrosClientWindow open.!
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:34:22' prior: 50978136!
buildMorphicWindow

	| loginButtonMorph userRowLayoutMorph passwordRowLayoutMorph usernameTextBoxMorph |
	loginButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #loginRequest
		label: 'Login'.
	
	usernameTextBoxMorph := TextModelMorph
		textProvider: self model
		textGetter: #usernameText
		textSetter: #usernameText:.
	
	usernameTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			usernameTextBoxMorph innerTextMorph acceptContents ] .

	usernameTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.

	userRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Username');
		axisEdgeWeight: 0.5;
		yourself.
	
	passwordRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Password');
		axisEdgeWeight: 0.5;
		yourself.

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0; "TODO: metodo para declaratividad"
		addMorph: userRowLayoutMorph;
		addMorph: passwordRowLayoutMorph;
		addMorph: loginButtonMorph.

	! !
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:34:28' prior: 50978162!
buildMorphicWindow

	| loginButtonMorph userRowLayoutMorph passwordRowLayoutMorph usernameTextBoxMorph |

	loginButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #loginRequest
		label: 'Login'.
	
	usernameTextBoxMorph := TextModelMorph
		textProvider: self model
		textGetter: #usernameText
		textSetter: #usernameText:.
	
	usernameTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			usernameTextBoxMorph innerTextMorph acceptContents ] .

	usernameTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.

	userRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Username');
		axisEdgeWeight: 0.5;
		yourself.
	
	passwordRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Password');
		axisEdgeWeight: 0.5;
		yourself.

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0; "TODO: metodo para declaratividad"
		addMorph: userRowLayoutMorph;
		addMorph: passwordRowLayoutMorph;
		addMorph: loginButtonMorph.

	! !
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:34:44' prior: 50978199!
buildMorphicWindow

	| loginButtonMorph userRowLayoutMorph passwordRowLayoutMorph usernameTextBoxMorph |

	loginButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #loginRequest
		label: 'Login'.
	
	usernameTextBoxMorph := TextModelMorph
		textProvider: self model
		textGetter: #usernameText
		textSetter: #usernameText:.
	
	usernameTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			usernameTextBoxMorph innerTextMorph acceptContents ] .

	usernameTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.

	userRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Username');
		axisEdgeWeight: 0.5;
		yourself.
	
	passwordRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Password');
		axisEdgeWeight: 0.5;
		yourself.

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0; "TODO: metodo para declaratividad"
		addMorph: userRowLayoutMorph;
		addMorph: passwordRowLayoutMorph;
		addMorph: loginButtonMorph.

	! !
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:34:52' prior: 50978236!
buildMorphicWindow

	| loginButtonMorph userRowLayoutMorph passwordRowLayoutMorph usernameTextBoxMorph |

	loginButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #loginRequest
		label: 'Login'.
	
	usernameTextBoxMorph := TextModelMorph
		textProvider: self model
		textGetter: #usernameText
		textSetter: #usernameText:.
	
	usernameTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			usernameTextBoxMorph innerTextMorph acceptContents ] .

	usernameTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.

	userRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Username');
		addMorph: usernameTextBoxMorph;
		axisEdgeWeight: 0.5;
		yourself.
	
	passwordRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Password');
		axisEdgeWeight: 0.5;
		yourself.

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0; "TODO: metodo para declaratividad"
		addMorph: userRowLayoutMorph;
		addMorph: passwordRowLayoutMorph;
		addMorph: loginButtonMorph.

	! !
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:35:27' prior: 50978273!
buildMorphicWindow

	| loginButtonMorph userRowLayoutMorph passwordRowLayoutMorph usernameTextBoxMorph passwordTextBoxMorph |

	loginButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #loginRequest
		label: 'Login'.
	
	usernameTextBoxMorph := TextModelMorph
		textProvider: self model
		textGetter: #usernameText
		textSetter: #usernameText:.
	
	usernameTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			usernameTextBoxMorph innerTextMorph acceptContents ] .

	usernameTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.
		
	passwordTextBoxMorph _ TextModelMorph
		textProvider: self model
		textGetter: #usernameText
		textSetter: #usernameText:.
	
	passwordTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			passwordTextBoxMorph innerTextMorph acceptContents ] .

	passwordTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.

	userRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Username');
		addMorph: usernameTextBoxMorph;
		axisEdgeWeight: 0.5;
		yourself.
	
	passwordRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Password');
		addMorph: passwordTextBoxMorph;
		axisEdgeWeight: 0.5;
		yourself.

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0; "TODO: metodo para declaratividad"
		addMorph: userRowLayoutMorph;
		addMorph: passwordRowLayoutMorph;
		addMorph: loginButtonMorph.

	! !

TusLibrosClientWindow open.!

!classDefinition: #TusLibrosClientWindowModel category: 'TusLibros' stamp: 'MP 11/17/2021 23:35:53'!
Object subclass: #TusLibrosClientWindowModel
	instanceVariableNames: 'username'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosClientWindowModel methodsFor: 'no messages' stamp: 'MP 11/17/2021 23:35:51'!
usernameText

	^ username! !

!classDefinition: #TusLibrosClientWindowModel category: 'TusLibros' stamp: 'MP 11/17/2021 23:35:58'!
Object subclass: #TusLibrosClientWindowModel
	instanceVariableNames: 'username password'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosClientWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:35:57'!
passwordText

	^ password! !
!TusLibrosClientWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:36:09' overrides: 16896425!
initialize

	username _ ''.
	password _ ''.! !

TusLibrosClientWindow open.!
!TusLibrosClientWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:36:35'!
passwordText: aPassword

	password _ aPassword! !
!TusLibrosClientWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:36:43'!
usernameText: aUsername

	username _ aUsername.! !

TusLibrosClientWindow open.!
!TusLibrosClientWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:37:28'!
loginRequest

	Transcript show: username, password! !

TusLibrosClientWindow open.!

Transcript show: 'hola'!

Transcript show: 'hola'!

Transcript!
!TusLibrosClientWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:38:28' prior: 50978405!
loginRequest

	Transcript show: username, password display.! !

Transcript show: 'hola' display!

Transcript show: 'hola'; display!

Transcript show: 'hola'; display!

Transcript show: 'hola'; display!

Transcript show: 'hola'; display!

Transcript show: 'hola'; display!

Transcript show: 'hola'; display!

Transcript show: 'hola'; display!

Transcript log: 'hola'!

Transcript log: 'hola'!

Transcript log: 'hola'!

Transcript log: 'hola'!

Transcript log: 'hola'!

Transcript log: 'hola'!

Transcript log: 'hola'!

Transcript log: 'hola'!

----End fileIn of /home/mnpanic/Documents/dc/ing1/cuis/cuis-tus-libros-it4/Packages/TerseGuide.pck.st----!
!TusLibrosClientWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:39:39' prior: 50978414!
loginRequest

	TranscriptWindow openTranscript.
	Transcript show: username, password.! !

TusLibrosClientWindow open.!
!TusLibrosClientWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:40:50' prior: 50981361!
loginRequest

	TranscriptWindow openTranscript.
	Transcript show: (username, password).! !

TusLibrosClientWindow open.!
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:41:45' prior: 50978311!
buildMorphicWindow

	| loginButtonMorph userRowLayoutMorph passwordRowLayoutMorph usernameTextBoxMorph passwordTextBoxMorph |

	loginButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #loginRequest
		label: 'Login'.
	
	usernameTextBoxMorph := TextModelMorph
		textProvider: self model
		textGetter: #usernameText
		textSetter: #usernameText:.
	
	usernameTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			usernameTextBoxMorph innerTextMorph acceptContents ] .

	usernameTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.
		
	passwordTextBoxMorph _ TextModelMorph
		textProvider: self model
		textGetter: #usernameText
		textSetter: #usernameText:.
	
	passwordTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			passwordTextBoxMorph innerTextMorph acceptContents ].

	passwordTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.

	userRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Username');
		addMorph: usernameTextBoxMorph;
		axisEdgeWeight: 0.5;
		yourself.
	
	passwordRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Password');
		addMorph: passwordTextBoxMorph;
		axisEdgeWeight: 0.5;
		yourself.

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0; "TODO: metodo para declaratividad"
		addMorph: userRowLayoutMorph;
		addMorph: passwordRowLayoutMorph;
		addMorph: loginButtonMorph.

	! !
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:41:48' prior: 50981377!
buildMorphicWindow

	| loginButtonMorph userRowLayoutMorph passwordRowLayoutMorph usernameTextBoxMorph passwordTextBoxMorph |

	loginButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #loginRequest
		label: 'Login'.
	
	usernameTextBoxMorph := TextModelMorph
		textProvider: self model
		textGetter: #usernameText
		textSetter: #usernameText:.
	
	usernameTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			usernameTextBoxMorph innerTextMorph acceptContents ] .

	usernameTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.
		
	passwordTextBoxMorph _ TextModelMorph
		textProvider: self model
		textGetter: #usernameText
		textSetter: #usernameText:.
	
	"passwordTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			passwordTextBoxMorph innerTextMorph acceptContents ]."

	passwordTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.

	userRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Username');
		addMorph: usernameTextBoxMorph;
		axisEdgeWeight: 0.5;
		yourself.
	
	passwordRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Password');
		addMorph: passwordTextBoxMorph;
		axisEdgeWeight: 0.5;
		yourself.

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0; "TODO: metodo para declaratividad"
		addMorph: userRowLayoutMorph;
		addMorph: passwordRowLayoutMorph;
		addMorph: loginButtonMorph.

	! !
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:41:57' prior: 50981428!
buildMorphicWindow

	| loginButtonMorph userRowLayoutMorph passwordRowLayoutMorph usernameTextBoxMorph passwordTextBoxMorph |

	loginButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #loginRequest
		label: 'Login'.
	
	usernameTextBoxMorph := TextModelMorph
		textProvider: self model
		textGetter: #usernameText
		textSetter: #usernameText:.
	
	"usernameTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			usernameTextBoxMorph innerTextMorph acceptContents ]."

	usernameTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.
		
	passwordTextBoxMorph _ TextModelMorph
		textProvider: self model
		textGetter: #usernameText
		textSetter: #usernameText:.
	
	"passwordTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			passwordTextBoxMorph innerTextMorph acceptContents ]."

	passwordTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.

	userRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Username');
		addMorph: usernameTextBoxMorph;
		axisEdgeWeight: 0.5;
		yourself.
	
	passwordRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Password');
		addMorph: passwordTextBoxMorph;
		axisEdgeWeight: 0.5;
		yourself.

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0; "TODO: metodo para declaratividad"
		addMorph: userRowLayoutMorph;
		addMorph: passwordRowLayoutMorph;
		addMorph: loginButtonMorph.

	! !

TusLibrosClientWindow open.!
!TusLibrosClientWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:42:39' prior: 50981369!
loginRequest

	TranscriptWindow openTranscript.
	Transcript clear.
	Transcript show: (username, password).! !
!TusLibrosClientWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:42:51' prior: 50981531!
loginRequest

	TranscriptWindow openTranscript.
	Transcript clear.
	Transcript show: username.
	Transcript show: password.! !
!TusLibrosClientWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:43:14' prior: 50978394!
passwordText: aPassword

	password _ aPassword.
	^true.! !
!TusLibrosClientWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:43:21' prior: 50978399!
usernameText: aUsername

	username _ aUsername.
	^true.! !

TusLibrosClientWindow open.!
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:43:52' prior: 50981479!
buildMorphicWindow

	| loginButtonMorph userRowLayoutMorph passwordRowLayoutMorph usernameTextBoxMorph passwordTextBoxMorph |

	loginButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #loginRequest
		label: 'Login'.
	
	usernameTextBoxMorph := TextModelMorph
		textProvider: self model
		textGetter: #usernameText
		textSetter: #usernameText:.
	
	usernameTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			usernameTextBoxMorph innerTextMorph acceptContents ].

	usernameTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.
		
	passwordTextBoxMorph _ TextModelMorph
		textProvider: self model
		textGetter: #usernameText
		textSetter: #usernameText:.
	
	passwordTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			passwordTextBoxMorph innerTextMorph acceptContents ].

	passwordTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.

	userRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Username');
		addMorph: usernameTextBoxMorph;
		axisEdgeWeight: 0.5;
		yourself.
	
	passwordRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Password');
		addMorph: passwordTextBoxMorph;
		axisEdgeWeight: 0.5;
		yourself.

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0; "TODO: metodo para declaratividad"
		addMorph: userRowLayoutMorph;
		addMorph: passwordRowLayoutMorph;
		addMorph: loginButtonMorph.

	! !

TusLibrosClientWindow open.!

TusLibrosClientWindow open.!
!TusLibrosClientWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:44:31' prior: 50981538!
loginRequest

	TranscriptWindow openTranscript.
	Transcript clear.
	Transcript log: username.
	Transcript log: password.! !

TusLibrosClientWindow open.!
!TusLibrosClientWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:44:43' prior: 50981612!
loginRequest

	TranscriptWindow openTranscript.
	Transcript clear.
	Transcript log: username, password.
	Transcript log: password.! !

TusLibrosClientWindow open.!
!TusLibrosClientWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:44:54' prior: 50981621!
loginRequest
	self halt.
	TranscriptWindow openTranscript.
	Transcript clear.
	Transcript log: username, password.
	Transcript log: password.! !

TusLibrosClientWindow open.!

TusLibrosClientWindow open.!
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:46:01' prior: 50981559!
buildMorphicWindow

	| loginButtonMorph userRowLayoutMorph passwordRowLayoutMorph usernameTextBoxMorph passwordTextBoxMorph |

	loginButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #loginRequest
		label: 'Login'.
	
	usernameTextBoxMorph := TextModelMorph
		textProvider: self model
		textGetter: #usernameText
		textSetter: #usernameText:.
	
	usernameTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			usernameTextBoxMorph innerTextMorph acceptContents ].

	usernameTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.
		
	passwordTextBoxMorph _ TextModelMorph
		textProvider: self model
		textGetter: #passwordText
		textSetter: #passwordText:.
	
	passwordTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			passwordTextBoxMorph innerTextMorph acceptContents ].

	passwordTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.

	userRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Username');
		addMorph: usernameTextBoxMorph;
		axisEdgeWeight: 0.5;
		yourself.
	
	passwordRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Password');
		addMorph: passwordTextBoxMorph;
		axisEdgeWeight: 0.5;
		yourself.

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0; "TODO: metodo para declaratividad"
		addMorph: userRowLayoutMorph;
		addMorph: passwordRowLayoutMorph;
		addMorph: loginButtonMorph.

	! !

TusLibrosClientWindow open.!
!TusLibrosClientWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:46:15' prior: 50981630!
loginRequest

	TranscriptWindow openTranscript.
	Transcript clear.
	Transcript log: username, password.
	Transcript log: password.! !
!TusLibrosClientWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 23:46:28' prior: 50981692!
loginRequest

	TranscriptWindow openTranscript.
	Transcript clear.
	Transcript log: username.
	Transcript log: password.! !

----SNAPSHOT----(17 November 2021 23:46:54) CuisUniversity-4972.image priorSource: 20681637!

----SNAPSHOT----(18 November 2021 01:18:22) CuisUniversity-4972.image priorSource: 20801787!

----STARTUP---- (18 November 2021 17:40:36) as /home/mnpanic/Documents/dc/ing1/cuis/cuis-tus-libros-it4/CuisUniversity-4972.image!


TusLibrosClientWindow open.!

self closeBoxHit !

TusLibrosClientWindow open.!
!TusLibrosClientWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 17:53:52' prior: 50981700!
loginRequest

	self triggerEvent: #loginSuccessful withArguments: { username. password }.! !
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 18:08:26' prior: 50981640!
buildMorphicWindow

	| loginButtonMorph userRowLayoutMorph passwordRowLayoutMorph usernameTextBoxMorph passwordTextBoxMorph |

	loginButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #loginRequest
		label: 'Login'.
	
	usernameTextBoxMorph := TextModelMorph
		textProvider: self model
		textGetter: #username
		textSetter: #username:.
	
	usernameTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			usernameTextBoxMorph innerTextMorph acceptContents ].

	usernameTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.
		
	passwordTextBoxMorph _ TextModelMorph
		textProvider: self model
		textGetter: #passwordText
		textSetter: #passwordText:.
	
	passwordTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			passwordTextBoxMorph innerTextMorph acceptContents ].

	passwordTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.

	userRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Username');
		addMorph: usernameTextBoxMorph;
		axisEdgeWeight: 0.5;
		yourself.
	
	passwordRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Password');
		addMorph: passwordTextBoxMorph;
		axisEdgeWeight: 0.5;
		yourself.

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0; "TODO: metodo para declaratividad"
		addMorph: userRowLayoutMorph;
		addMorph: passwordRowLayoutMorph;
		addMorph: loginButtonMorph.

	! !
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 18:08:31' prior: 50981727!
buildMorphicWindow

	| loginButtonMorph userRowLayoutMorph passwordRowLayoutMorph usernameTextBoxMorph passwordTextBoxMorph |

	loginButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #loginRequest
		label: 'Login'.
	
	usernameTextBoxMorph := TextModelMorph
		textProvider: self model
		textGetter: #username
		textSetter: #username:.
	
	usernameTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			usernameTextBoxMorph innerTextMorph acceptContents ].

	usernameTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.
		
	passwordTextBoxMorph _ TextModelMorph
		textProvider: self model
		textGetter: #password
		textSetter: #password:.
	
	passwordTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			passwordTextBoxMorph innerTextMorph acceptContents ].

	passwordTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.

	userRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Username');
		addMorph: usernameTextBoxMorph;
		axisEdgeWeight: 0.5;
		yourself.
	
	passwordRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Password');
		addMorph: passwordTextBoxMorph;
		axisEdgeWeight: 0.5;
		yourself.

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0; "TODO: metodo para declaratividad"
		addMorph: userRowLayoutMorph;
		addMorph: passwordRowLayoutMorph;
		addMorph: loginButtonMorph.

	! !
!TusLibrosClientWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 18:08:36'!
password

	^ password! !

!methodRemoval: TusLibrosClientWindowModel #passwordText stamp: 'MP 11/18/2021 18:08:36'!
passwordText

	^ password!
!TusLibrosClientWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 18:08:40'!
password: aPassword

	password _ aPassword.
	^true.! !

!methodRemoval: TusLibrosClientWindowModel #passwordText: stamp: 'MP 11/18/2021 18:08:40'!
passwordText: aPassword

	password _ aPassword.
	^true.!
!TusLibrosClientWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 18:08:43'!
username

	^ username! !

!methodRemoval: TusLibrosClientWindowModel #usernameText stamp: 'MP 11/18/2021 18:08:43'!
usernameText

	^ username!
!TusLibrosClientWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 18:08:46'!
username: aUsername

	username _ aUsername.
	^true.! !

!methodRemoval: TusLibrosClientWindowModel #usernameText: stamp: 'MP 11/18/2021 18:08:46'!
usernameText: aUsername

	username _ aUsername.
	^true.!

!classRenamed: #TusLibrosClientWindowModel as: #TusLibrosClientModel stamp: 'MP 11/18/2021 18:13:43'!
Smalltalk renameClassNamed: #TusLibrosClientWindowModel as: #TusLibrosClientModel!
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 18:13:43' prior: 50977971!
initializeWith: aTitle

	self setLabel: aTitle.
	self model: (TusLibrosClientModel new).
	self buildMorphicWindow.
	self openInWorld.! !

----SNAPSHOT----(18 November 2021 22:27:20) CuisUniversity-4972.image priorSource: 20801881!

----STARTUP---- (18 November 2021 23:22:39) as /home/mnpanic/Documents/dc/ing1/cuis/cuis-tus-libros-it4/CuisUniversity-4972.image!


TusLibrosClientWindow open.!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:29:30' prior: 50981720!
loginRequest

	self triggerEvent: #loginSuccessful! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:31:48' prior: 50981886!
loginRequest

	self triggerEvent: #loginSuccessful! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:37:27' prior: 50981891!
loginRequest

	self createCart.

	self triggerEvent: #loginSuccessful! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:37:30'!
createCart

	! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:41:58' prior: 50981902!
createCart

	| fieldDict resp urlEncodedSentence |

	fieldDict _ Dictionary new
		at: 'user' put: username;
		at: 'password' put: password;
		yourself.
	
	resp _ WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:43:00' prior: 50981906!
createCart

	| fields resp urlEncodedSentence |

	fields _ Dictionary new
		at: 'user' put: username;
		at: 'password' put: password;
		yourself.

	resp _ WebClient htmlSubmit: (self url,'/words') fields: fields.

	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:43:59' prior: 50981921!
createCart

	| fields resp |

	fields _ Dictionary new
		at: 'user' put: username;
		at: 'password' put: password;
		yourself.

	resp _ WebClient htmlSubmit: (self url,'/words') fields: fields.

	resp isSuccess 
		ifTrue: [^ WebUtils jsonDecode: resp content readStream asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:44:09' prior: 50981936!
createCart

	| fields resp |

	fields _ Dictionary new
		at: 'user' put: username;
		at: 'password' put: password;
		yourself.

	resp _ WebClient htmlSubmit: (self url, '/words') fields: fields.

	resp isSuccess 
		ifTrue: [^ WebUtils jsonDecode: resp content readStream asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:44:24'!
url

	^ 'http://localhost:', self port asString! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:44:29'!
port

	^ 8080! !
!TestObjectFactory methodsFor: 'store creation' stamp: 'MP 11/18/2021 23:45:03'!
createCartRequest

	^ Cart acceptingProductsFrom: self defaultCatalog.! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:03'!
createCartRequest

	| fields resp |

	fields _ Dictionary new
		at: 'user' put: username;
		at: 'password' put: password;
		yourself.

	resp _ WebClient htmlSubmit: (self url, '/words') fields: fields.

	resp isSuccess 
		ifTrue: [^ WebUtils jsonDecode: resp content readStream asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !
!CheckoutTest methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:03' prior: 50973729!
test01CannotCheckoutWithEmptyCart

	self assertCheckout: testObjectFactory createCartRequest
		charging: testObjectFactory validCard
		raises: Cashier emptyCartErrorDescription.! !
!CheckoutTest methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:03' prior: 50973771!
test04CheckoutOfCartWithMultipleItemsReturnsReceiptWithASumOfTheirPrices

	| cart cashier quantity expectedRecepit receipt |
	cart _ testObjectFactory createCartRequest.
	cashier _ testObjectFactory createCashier.
	quantity _ 5.
	
	cart add: quantity of: testObjectFactory firstProductSoldByTheStore.
	cart add: testObjectFactory secondProductSoldByTheStore.
	
	receipt _ cashier 
		checkout: cart 
		charging: testObjectFactory validCard 
		on: testObjectFactory fixedDate.
	
	expectedRecepit _
		(quantity * testObjectFactory firstProductSoldByTheStorePrice) +
		(testObjectFactory secondProductSoldByTheStorePrice).

	self 
		assert: expectedRecepit
		equals: receipt.! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:03' prior: 50981896!
loginRequest

	self createCartRequest.

	self triggerEvent: #loginSuccessful! !
!CheckoutTest methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:03' prior: 50973737!
test02CheckoutOfCartWithSingleItemReturnsReceiptOfItsPrice

	| cart cashier receipt |
	cart _ testObjectFactory createCartRequest.
	cashier _ testObjectFactory createCashier.
	
	cart add: testObjectFactory firstProductSoldByTheStore.
	
	receipt _ cashier 
		checkout: cart 
		charging: testObjectFactory validCard 
		on: testObjectFactory fixedDate.

	self assert: testObjectFactory firstProductSoldByTheStorePrice equals: receipt.! !
!TestObjectFactory methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:03' prior: 50974859!
createCartWithSingleProduct

	^ self createCartRequest
		add: self firstProductSoldByTheStore;
		yourself.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:03' prior: 50973675!
test07CantAddBookWithNegativeQuantity

	| cart |
	cart _ testObjectFactory createCartRequest.

	self assertAdding: testObjectFactory firstProductSoldByTheStore
		withQuantity: -1 
		to: cart 
		raises: Cart invalidQuantityErrorDescription.! !
!CheckoutTest methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:03' prior: 50973753!
test03CheckoutOfCartWithItemWithMultipleOcurrencesReturnsRecepitOfItsTotalPrice

	| cart cashier quantity receipt |
	cart _ testObjectFactory createCartRequest.
	cashier _ testObjectFactory createCashier.
	quantity _ 5.
	
	cart add: quantity of: testObjectFactory firstProductSoldByTheStore.
	
	receipt _ cashier 
		checkout: cart 
		charging: testObjectFactory validCard 
		on: testObjectFactory fixedDate.

	self 
		assert: (quantity * testObjectFactory firstProductSoldByTheStorePrice)
		equals: receipt.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:03' prior: 50973626!
test02CartWithABookShouldNotBeEmpty

	| cart |
	
	cart _ testObjectFactory createCartRequest.
	cart add: testObjectFactory firstProductSoldByTheStore.
	
	self deny: cart isEmpty ! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:03' prior: 50973665!
test06CantAddBookWithZeroQuantity

	| cart |
	cart _ testObjectFactory createCartRequest.
	
	self assertAdding: testObjectFactory secondProductSoldByTheStore 
		withQuantity: 0
		to: cart
		raises: Cart invalidQuantityErrorDescription.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:03' prior: 50973620!
test01NewCartIsEmpty

	| cart |

	cart _ testObjectFactory createCartRequest.
	
	self assert: cart isEmpty.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:03' prior: 50973634!
test03CartIncludesBookAfterAdding

	| cart |

	cart _ testObjectFactory createCartRequest.
	cart add: testObjectFactory firstProductSoldByTheStore .
	
	self assert: (cart includes: testObjectFactory firstProductSoldByTheStore).! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:03' prior: 50973643!
test04CantAddBookNotIncludedInCatalog

	| cart |
	
	cart _ testObjectFactory createCartRequest.
	
	self assertAdding: testObjectFactory productNotSoldByTheStore
		withQuantity: 1 
		to: cart 
		raises: Cart productNotInCatalogErrorDescription.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:03' prior: 50973653!
test05CartIncludesAllOccurrencesOfBookAfterAdding

	| cart quantity |

	cart _ testObjectFactory createCartRequest.
	quantity _ 5.
	cart add: quantity of: testObjectFactory firstProductSoldByTheStore.
	
	self assert: quantity equals: (cart occurrencesOf: testObjectFactory firstProductSoldByTheStore).! !

!methodRemoval: TestObjectFactory #createCart stamp: 'MP 11/18/2021 23:45:03'!
createCart

	^ Cart acceptingProductsFrom: self defaultCatalog.!

!methodRemoval: TusLibrosClientModel #createCart stamp: 'MP 11/18/2021 23:45:03'!
createCart

	| fields resp |

	fields _ Dictionary new
		at: 'user' put: username;
		at: 'password' put: password;
		yourself.

	resp _ WebClient htmlSubmit: (self url, '/words') fields: fields.

	resp isSuccess 
		ifTrue: [^ WebUtils jsonDecode: resp content readStream asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].!
!TestObjectFactory methodsFor: 'store creation' stamp: 'MP 11/18/2021 23:45:27'!
createCart

	^ Cart acceptingProductsFrom: self defaultCatalog.! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:27'!
createCart

	| fields resp |

	fields _ Dictionary new
		at: 'user' put: username;
		at: 'password' put: password;
		yourself.

	resp _ WebClient htmlSubmit: (self url, '/words') fields: fields.

	resp isSuccess 
		ifTrue: [^ WebUtils jsonDecode: resp content readStream asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:27' prior: 50982027!
loginRequest

	self createCart.

	self triggerEvent: #loginSuccessful! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:27' prior: 50982057!
test07CantAddBookWithNegativeQuantity

	| cart |
	cart _ testObjectFactory createCart.

	self assertAdding: testObjectFactory firstProductSoldByTheStore
		withQuantity: -1 
		to: cart 
		raises: Cart invalidQuantityErrorDescription.! !
!CheckoutTest methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:27' prior: 50982068!
test03CheckoutOfCartWithItemWithMultipleOcurrencesReturnsRecepitOfItsTotalPrice

	| cart cashier quantity receipt |
	cart _ testObjectFactory createCart.
	cashier _ testObjectFactory createCashier.
	quantity _ 5.
	
	cart add: quantity of: testObjectFactory firstProductSoldByTheStore.
	
	receipt _ cashier 
		checkout: cart 
		charging: testObjectFactory validCard 
		on: testObjectFactory fixedDate.

	self 
		assert: (quantity * testObjectFactory firstProductSoldByTheStorePrice)
		equals: receipt.! !
!CheckoutTest methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:27' prior: 50981993!
test01CannotCheckoutWithEmptyCart

	self assertCheckout: testObjectFactory createCart
		charging: testObjectFactory validCard
		raises: Cashier emptyCartErrorDescription.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:27' prior: 50982087!
test02CartWithABookShouldNotBeEmpty

	| cart |
	
	cart _ testObjectFactory createCart.
	cart add: testObjectFactory firstProductSoldByTheStore.
	
	self deny: cart isEmpty ! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:27' prior: 50982096!
test06CantAddBookWithZeroQuantity

	| cart |
	cart _ testObjectFactory createCart.
	
	self assertAdding: testObjectFactory secondProductSoldByTheStore 
		withQuantity: 0
		to: cart
		raises: Cart invalidQuantityErrorDescription.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:27' prior: 50982107!
test01NewCartIsEmpty

	| cart |

	cart _ testObjectFactory createCart.
	
	self assert: cart isEmpty.! !
!CheckoutTest methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:27' prior: 50982033!
test02CheckoutOfCartWithSingleItemReturnsReceiptOfItsPrice

	| cart cashier receipt |
	cart _ testObjectFactory createCart.
	cashier _ testObjectFactory createCashier.
	
	cart add: testObjectFactory firstProductSoldByTheStore.
	
	receipt _ cashier 
		checkout: cart 
		charging: testObjectFactory validCard 
		on: testObjectFactory fixedDate.

	self assert: testObjectFactory firstProductSoldByTheStorePrice equals: receipt.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:27' prior: 50982136!
test05CartIncludesAllOccurrencesOfBookAfterAdding

	| cart quantity |

	cart _ testObjectFactory createCart.
	quantity _ 5.
	cart add: quantity of: testObjectFactory firstProductSoldByTheStore.
	
	self assert: quantity equals: (cart occurrencesOf: testObjectFactory firstProductSoldByTheStore).! !
!CheckoutTest methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:27' prior: 50982002!
test04CheckoutOfCartWithMultipleItemsReturnsReceiptWithASumOfTheirPrices

	| cart cashier quantity expectedRecepit receipt |
	cart _ testObjectFactory createCart.
	cashier _ testObjectFactory createCashier.
	quantity _ 5.
	
	cart add: quantity of: testObjectFactory firstProductSoldByTheStore.
	cart add: testObjectFactory secondProductSoldByTheStore.
	
	receipt _ cashier 
		checkout: cart 
		charging: testObjectFactory validCard 
		on: testObjectFactory fixedDate.
	
	expectedRecepit _
		(quantity * testObjectFactory firstProductSoldByTheStorePrice) +
		(testObjectFactory secondProductSoldByTheStorePrice).

	self 
		assert: expectedRecepit
		equals: receipt.! !
!TestObjectFactory methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:27' prior: 50982050!
createCartWithSingleProduct

	^ self createCart
		add: self firstProductSoldByTheStore;
		yourself.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:28' prior: 50982114!
test03CartIncludesBookAfterAdding

	| cart |

	cart _ testObjectFactory createCart.
	cart add: testObjectFactory firstProductSoldByTheStore .
	
	self assert: (cart includes: testObjectFactory firstProductSoldByTheStore).! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:28' prior: 50982125!
test04CantAddBookNotIncludedInCatalog

	| cart |
	
	cart _ testObjectFactory createCart.
	
	self assertAdding: testObjectFactory productNotSoldByTheStore
		withQuantity: 1 
		to: cart 
		raises: Cart productNotInCatalogErrorDescription.! !

!methodRemoval: TestObjectFactory #createCartRequest stamp: 'MP 11/18/2021 23:45:28'!
createCartRequest

	^ Cart acceptingProductsFrom: self defaultCatalog.!

!methodRemoval: TusLibrosClientModel #createCartRequest stamp: 'MP 11/18/2021 23:45:28'!
createCartRequest

	| fields resp |

	fields _ Dictionary new
		at: 'user' put: username;
		at: 'password' put: password;
		yourself.

	resp _ WebClient htmlSubmit: (self url, '/words') fields: fields.

	resp isSuccess 
		ifTrue: [^ WebUtils jsonDecode: resp content readStream asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:41'!
createCartRequest

	| fields resp |

	fields _ Dictionary new
		at: 'user' put: username;
		at: 'password' put: password;
		yourself.

	resp _ WebClient htmlSubmit: (self url, '/words') fields: fields.

	resp isSuccess 
		ifTrue: [^ WebUtils jsonDecode: resp content readStream asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:45:41' prior: 50982185!
loginRequest

	self createCartRequest.

	self triggerEvent: #loginSuccessful! !

!methodRemoval: TusLibrosClientModel #createCart stamp: 'MP 11/18/2021 23:45:41'!
createCart

	| fields resp |

	fields _ Dictionary new
		at: 'user' put: username;
		at: 'password' put: password;
		yourself.

	resp _ WebClient htmlSubmit: (self url, '/words') fields: fields.

	resp isSuccess 
		ifTrue: [^ WebUtils jsonDecode: resp content readStream asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #CartTest #test02CartWithABookShouldNotBeEmpty stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #CartTest #test03CartIncludesBookAfterAdding stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #CartTest #test04CantAddBookNotIncludedInCatalog stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #CartTest #test05CartIncludesAllOccurrencesOfBookAfterAdding stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #CartTest #test06CantAddBookWithZeroQuantity stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #CartTest #test07CantAddBookWithNegativeQuantity stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #CheckoutTest #test01CannotCheckoutWithEmptyCart stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #CheckoutTest #test02CheckoutOfCartWithSingleItemReturnsReceiptOfItsPrice stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #CheckoutTest #test03CheckoutOfCartWithItemWithMultipleOcurrencesReturnsRecepitOfItsTotalPrice stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #CheckoutTest #test04CheckoutOfCartWithMultipleItemsReturnsReceiptWithASumOfTheirPrices stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #CheckoutTest #test05CannotCheckoutWithExpiredCard stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #CheckoutTest #test06CannotCheckoutWithInvalidNumberCard stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #CheckoutTest #test07CannotCheckoutWithCardWithoutFunds stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #CheckoutTest #test08CannotCheckoutWithStolenCard stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CannotCreateCartWithInvalidCredentials stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CartCreatedWithValidCredentialsIsEmpty stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03AddingMultipleOcurrencesOfAProductListsEachOne stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04AddingToACartDoesntAffectTheOthers stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CannotAddProductToCartWithInvalidId stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CannotListCartWithInvalidId stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07CannotCheckoutInvalidCartId stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CheckoutOfCartRegistersSales stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09CheckoutReturnsDifferentIdsEachTime stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CannotListExpiredCart stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CartsExpireOnlyAfterThirtyMinutes stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12ListingRefreshesCart stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CannotAddProductsToExpiredCart stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14CannotCheckoutExpiredCart stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15AddingProductsRefreshesCart stamp: 'MP 11/18/2021 23:45:51'!
PASSED!

!classDefinition: #TusLibrosClientModel category: 'TusLibros' stamp: 'MP 11/18/2021 23:46:16'!
Object subclass: #TusLibrosClientModel
	instanceVariableNames: 'username password cartId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:46:15'!
createCart

	cartId _ self createCartRequest.! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:50:08'!
login

	self createCartRequest.

	self triggerEvent: #loginSuccessful! !

!methodRemoval: TusLibrosClientModel #loginRequest stamp: 'MP 11/18/2021 23:50:08'!
loginRequest

	self createCartRequest.

	self triggerEvent: #loginSuccessful!
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:50:22' prior: 50981778!
buildMorphicWindow

	| loginButtonMorph userRowLayoutMorph passwordRowLayoutMorph usernameTextBoxMorph passwordTextBoxMorph |

	loginButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #login
		label: 'Login'.
	
	usernameTextBoxMorph := TextModelMorph
		textProvider: self model
		textGetter: #username
		textSetter: #username:.
	
	usernameTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			usernameTextBoxMorph innerTextMorph acceptContents ].

	usernameTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.
		
	passwordTextBoxMorph _ TextModelMorph
		textProvider: self model
		textGetter: #password
		textSetter: #password:.
	
	passwordTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			passwordTextBoxMorph innerTextMorph acceptContents ].

	passwordTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.

	userRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Username');
		addMorph: usernameTextBoxMorph;
		axisEdgeWeight: 0.5;
		yourself.
	
	passwordRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Password');
		addMorph: passwordTextBoxMorph;
		axisEdgeWeight: 0.5;
		yourself.

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0; "TODO: metodo para declaratividad"
		addMorph: userRowLayoutMorph;
		addMorph: passwordRowLayoutMorph;
		addMorph: loginButtonMorph.

	! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:51:22' prior: 50982506!
createCart

	cartId _ self createCartRequest.! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:51:33' prior: 50982511!
login

	self triggerEvent: #loginSuccessful! !
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:52:19' prior: 50981870!
initializeWith: aTitle

	self setLabel: aTitle.
	self model: (TusLibrosClientModel new).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #loginSuccessful send: #openMainWindow to: self.! !

!classDefinition: #TusLibrosClientMainWindow category: 'TusLibros' stamp: 'MP 11/18/2021 23:52:40'!
Object subclass: #TusLibrosClientMainWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosClientWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:52:37'!
openMainWindow

	TusLibrosClientMainWindow open.! !

SystemWindow subclass: #TusLibrosClientMainWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #TusLibrosClientMainWindow category: 'TusLibros' stamp: 'MP 11/18/2021 23:52:51'!
SystemWindow subclass: #TusLibrosClientMainWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosClientMainWindow class methodsFor: 'nil' stamp: 'MP 11/18/2021 23:52:56'!
open

! !
!TusLibrosClientMainWindow class methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:53:04' prior: 50982616!
open

	^self new initializeWith: 'TusLibros Client Window'.! !
!TusLibrosClientMainWindow methodsFor: 'nil' stamp: 'MP 11/18/2021 23:54:09'!
initializeWith: aTitle

	self setLabel: aTitle.
	self model: (TusLibrosClientModel new).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #loginSuccessful send: #openMainWindow to: self.! !
!TusLibrosClientMainWindow class methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:56:00' prior: 50982620!
open

	^self new initializeWith: 'TusLibros Main Client'.! !
!TusLibrosClientMainWindow class methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:56:20'!
openWithModel: aTusLibrosModel

	^self new initializeWithModel: aTusLibrosModel name: 'TusLibros Main Client'.! !
!TusLibrosClientMainWindow class methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:56:26' prior: 50982642!
openWithModel: aTusLibrosModel

	^self new initializeWithModel: aTusLibrosModel title: 'TusLibros Main Client'.! !

!methodRemoval: TusLibrosClientMainWindow class #open stamp: 'MP 11/18/2021 23:56:33'!
open

	^self new initializeWith: 'TusLibros Main Client'.!

!classDefinition: #TusLibrosClientMainWindow category: 'TusLibros' stamp: 'MP 11/18/2021 23:56:59'!
SystemWindow subclass: #TusLibrosClientMainWindow
	instanceVariableNames: 'clientModel'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:56:58'!
initializeWithModel: aTusLibrosClientModel title: aTitle

	clientModel _ aTusLibrosClientModel.

	self setLabel: aTitle.
	self model: (TusLibrosClientModel new).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #loginSuccessful send: #openMainWindow to: self.! !

!methodRemoval: TusLibrosClientMainWindow #initializeWith: stamp: 'MP 11/18/2021 23:57:03'!
initializeWith: aTitle

	self setLabel: aTitle.
	self model: (TusLibrosClientModel new).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #loginSuccessful send: #openMainWindow to: self.!
!TusLibrosClientMainWindow class methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:57:08' prior: 50982650!
openWithModel: aTusLibrosClientModel

	^self new initializeWithModel: aTusLibrosClientModel title: 'TusLibros Main Client'.! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:57:20' prior: 50982670!
initializeWithModel: aTusLibrosClientModel title: aTitle
	self setLabel: aTitle.
	self model: (aTusLibrosClientModel).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #loginSuccessful send: #openMainWindow to: self.! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:57:21' prior: 50982700!
initializeWithModel: aTusLibrosClientModel title: aTitle

	self setLabel: aTitle.
	self model: (aTusLibrosClientModel).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #loginSuccessful send: #openMainWindow to: self.! !

!classDefinition: #TusLibrosClientMainWindow category: 'TusLibros' stamp: 'MP 11/18/2021 23:57:24'!
SystemWindow subclass: #TusLibrosClientMainWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:57:32' prior: 50982711!
initializeWithModel: aTusLibrosClientModel title: aTitle

	self setLabel: aTitle.
	self model: aTusLibrosClientModel.
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #loginSuccessful send: #openMainWindow to: self.! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/18/2021 23:57:54' prior: 50982730!
initializeWithModel: aTusLibrosClientModel title: aTitle

	self setLabel: aTitle.
	self model: aTusLibrosClientModel.
	self buildMorphicWindow.
	
	self model createCart.
	
	"self model when: #loginSuccessful send: #openMainWindow to: self."
	
	self openInWorld.! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:00:19' prior: 50982741!
initializeWithModel: aTusLibrosClientModel title: aTitle

	self setLabel: aTitle.
	self model: aTusLibrosClientModel.
	self buildMorphicWindow.
	
	"self model when: #loginSuccessful send: #openMainWindow to: self."
	
	self openInWorld.! !

!classRenamed: #TusLibrosClientWindow as: #TusLibrosLoginWindow stamp: 'MP 11/19/2021 00:00:25'!
Smalltalk renameClassNamed: #TusLibrosClientWindow as: #TusLibrosLoginWindow!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:00:47' prior: 50982577!
login

		self model createCart.


	self triggerEvent: #loginSuccessful! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:00:51' prior: 50982770!
login

		self createCart.

	self triggerEvent: #loginSuccessful! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:00:52' prior: 50982776!
login

	self createCart.

	self triggerEvent: #loginSuccessful! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:01:30' prior: 50982782!
login

	"Pensando en modelos genricos es raro que en el login creemos un carrito,
	pero es la forma que tenemos de verificar el user y pass".
	self createCart.

	self triggerEvent: #loginSuccessful! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:01:32' prior: 50982788!
login

	"Pensando en modelos genricos es raro que en el login creemos un carrito,
	pero es la forma que tenemos de verificar el user y pass"
	self createCart.

	self triggerEvent: #loginSuccessful! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:01:50'!
buildMorphicWindow

	! !

!methodRemoval: TusLibrosClientModel #login stamp: 'MP 11/19/2021 00:03:55'!
login

	"Pensando en modelos genricos es raro que en el login creemos un carrito,
	pero es la forma que tenemos de verificar el user y pass"
	self createCart.

	self triggerEvent: #loginSuccessful!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:04:05' prior: 50982572!
createCart

	cartId _ self createCartRequest.
	
	self triggerEvent: #cartCreationSuccessful! !
!TusLibrosLoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:04:20' prior: 50982522!
buildMorphicWindow

	| loginButtonMorph userRowLayoutMorph passwordRowLayoutMorph usernameTextBoxMorph passwordTextBoxMorph |

	loginButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #createCart
		label: 'Create Cart'.
	
	usernameTextBoxMorph := TextModelMorph
		textProvider: self model
		textGetter: #username
		textSetter: #username:.
	
	usernameTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			usernameTextBoxMorph innerTextMorph acceptContents ].

	usernameTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.
		
	passwordTextBoxMorph _ TextModelMorph
		textProvider: self model
		textGetter: #password
		textSetter: #password:.
	
	passwordTextBoxMorph 
		innerTextMorph setProperty: #keyStroke: 
		toValue:  [ :key | 
			passwordTextBoxMorph innerTextMorph acceptContents ].

	passwordTextBoxMorph
		borderWidth: 1; 
		borderColor: Color skyBlue; 
		morphWidth: 300.

	userRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Username');
		addMorph: usernameTextBoxMorph;
		axisEdgeWeight: 0.5;
		yourself.
	
	passwordRowLayoutMorph _ LayoutMorph newRow
		addMorph: (LabelMorph contents: 'Password');
		addMorph: passwordTextBoxMorph;
		axisEdgeWeight: 0.5;
		yourself.

	self layoutMorph
		beColumn;
		separation: 15;
		axisEdgeWeight: 0; "TODO: metodo para declaratividad"
		addMorph: userRowLayoutMorph;
		addMorph: passwordRowLayoutMorph;
		addMorph: loginButtonMorph.

	! !
!TusLibrosLoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:04:26' prior: 50982582!
initializeWith: aTitle

	self setLabel: aTitle.
	self model: (TusLibrosClientModel new).
	self buildMorphicWindow.
	self openInWorld.
	
	self model when: #cartCreationSuccessful send: #openMainWindow to: self.! !
!TusLibrosLoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:04:39' prior: 50982599!
openMainWindow

	TusLibrosClientMainWindow openWithModel: self model.! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:21:08' prior: 50982808!
buildMorphicWindow
	
	| addToCartButtonMorph catalogAndButtonColumnLayoutMorph catalogMorph listPurchasesButtonMorph viewCartButtonMorph |
	catalogMorph := PluggableListMorph 
		model: self model 
		listGetter: #catalog
		indexGetter: #catalogIndex
		indexSetter: #catalogIndex:.

	addToCartButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #addToCart
		label: 'Add to cart'.
	
	catalogAndButtonColumnLayoutMorph _ LayoutMorph newColumn
		addMorph: catalogMorph;
		addMorph: addToCartButtonMorph;
		axisEdgeWeight: 0.5;
		yourself.
	
	viewCartButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #viewCart
		label: 'View cart'.

	listPurchasesButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #listPurchases
		label: 'List purchases'.

	self layoutMorph
		beRow;
		separation: 15;
		axisEdgeWeight: 0;
		addMorph: catalogAndButtonColumnLayoutMorph;
		addMorph: viewCartButtonMorph;
		addMorph: listPurchasesButtonMorph.! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:21:18' prior: 50982895!
buildMorphicWindow
	
	| addToCartButtonMorph catalogAndButtonColumnLayoutMorph catalogMorph listPurchasesButtonMorph viewCartButtonMorph |

	catalogMorph := PluggableListMorph 
		model: self model 
		listGetter: #catalog
		indexGetter: #catalogIndex
		indexSetter: #catalogIndex:.

	addToCartButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #addToCart
		label: 'Add to cart'.
	
	catalogAndButtonColumnLayoutMorph _ LayoutMorph newColumn
		addMorph: catalogMorph;
		addMorph: addToCartButtonMorph;
		axisEdgeWeight: 0.5;
		yourself.
	
	viewCartButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #viewCart
		label: 'View cart'.

	listPurchasesButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #listPurchases
		label: 'List purchases'.

	self layoutMorph
		beRow;
		separation: 15;
		axisEdgeWeight: 0;
		addMorph: catalogAndButtonColumnLayoutMorph;
		addMorph: viewCartButtonMorph;
		addMorph: listPurchasesButtonMorph.! !

TusLibrosLoginWindow open.!

----SNAPSHOT----(19 November 2021 00:22:36) CuisUniversity-4972.image priorSource: 20807240!

----STARTUP---- (19 November 2021 00:22:47) as /home/mnpanic/Documents/dc/ing1/cuis/cuis-tus-libros-it4/CuisUniversity-4972.image!

!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:24:28' prior: 50977765!
initializeOn: aPortNumber
	| testObjectFactory authenticationSystem |
	
	self halt.
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].

	self addService: '/listPurchases'
		withErrorSafeAction: [ :request | self handleListPurchases: request ].

	self addService: '/checkout'
		withErrorSafeAction: [ :request | self handleCheckout: request. ].
		
	! !

----SNAPSHOT----(19 November 2021 00:24:33) CuisUniversity-4972.image priorSource: 20842113!

----STARTUP---- (19 November 2021 00:24:37) as /home/mnpanic/Documents/dc/ing1/cuis/cuis-tus-libros-it4/CuisUniversity-4972.image!

!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:24:43' prior: 50982975!
initializeOn: aPortNumber
	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].

	self addService: '/listPurchases'
		withErrorSafeAction: [ :request | self handleListPurchases: request ].

	self addService: '/checkout'
		withErrorSafeAction: [ :request | self handleCheckout: request. ].
		
	! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:28:26' prior: 50982358!
createCartRequest

	| fields resp |

	fields _ Dictionary new
		at: 'user' put: username;
		at: 'password' put: password;
		yourself.

	resp _ WebClient htmlSubmit: (self url, '/createCart') fields: fields.

	resp isSuccess 
		ifTrue: [^ WebUtils jsonDecode: resp content readStream asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !

TusLibrosLoginWindow open.!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:28:48' prior: 50983061!
createCartRequest

	| fields resp |

	fields _ Dictionary new
		at: 'user' put: username;
		at: 'password' put: password;
		yourself.

	resp _ WebClient htmlSubmit: (self url, '/createCart') fields: fields.

	resp isSuccess 
		ifTrue: [^ WebUtils jsonDecode: resp content readStream ] 
		ifFalse:[ ^ self error: resp content ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:28:50' prior: 50983077!
createCartRequest

	| fields resp |

	fields _ Dictionary new
		at: 'user' put: username;
		at: 'password' put: password;
		yourself.

	resp _ WebClient htmlSubmit: (self url, '/createCart') fields: fields.

	resp isSuccess 
		ifTrue: [^ WebUtils jsonDecode: resp content ] 
		ifFalse:[ ^ self error: resp content ].! !

resp content!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:29:28' prior: 50983091!
createCartRequest

	| fields resp |

	fields _ Dictionary new
		at: 'user' put: username;
		at: 'password' put: password;
		yourself.

	resp _ WebClient htmlSubmit: (self url, '/createCart') fields: fields.

	resp isSuccess 
		ifTrue: [^ resp content asNumber ] 
		ifFalse:[ ^ self error: resp content ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:29:50'!
catalog
	self shouldBeImplemented.! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:30:03' prior: 50983118!
catalog
	
	^OrderedCollection new.! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:30:05' prior: 50983123!
catalog
	
	^ OrderedCollection new.! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:30:32'!
catalogIndex
	self shouldBeImplemented.! !

!classDefinition: #TusLibrosClientModel category: 'TusLibros' stamp: 'MP 11/19/2021 00:30:44'!
Object subclass: #TusLibrosClientModel
	instanceVariableNames: 'username password cartId catalogIndex'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:30:40' prior: 50983132!
catalogIndex
	
	^ catalogIndex! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:31:17'!
catalogIndex: aCatalogIndex
	
	catalogIndex _ aCatalogIndex.! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:31:20' prior: 50983150!
catalogIndex: aCatalogIndex
	
	catalogIndex _ aCatalogIndex.
	^true.! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:31:35' prior: 50983156!
catalogIndex: aCatalogIndex
	
	catalogIndex _ aCatalogIndex.! !

TusLibrosLoginWindow open.!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:32:53' prior: 50978388 overrides: 16896425!
initialize

	username _ ''.
	password _ ''.
	catalogIndex _ 0.! !

TusLibrosLoginWindow open.!
!TusLibrosLoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:34:06' prior: 50982889!
openMainWindow

	TusLibrosClientMainWindow openWithModel: self model.
	self closeBoxHit.! !

TusLibrosLoginWindow open.!

----SNAPSHOT----(19 November 2021 00:34:39) CuisUniversity-4972.image priorSource: 20843608!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:35:02' prior: 50983128!
catalog
	
	^ self catalogRequest.! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:36:14'!
catalogRequest

	| fields resp |

	resp _ WebClient httpGet: (self url, '/catalog').

	resp isSuccess 
		ifTrue: [^ resp content readStream asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:36:27' prior: 50983190!
catalogRequest

	| resp |

	resp _ WebClient httpGet: (self url, '/catalog').

	resp isSuccess 
		ifTrue: [^ WebUtils jsonDecode: resp content readStream asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !

TusLibrosLoginWindow open.!
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:37:36'!
handleCatalog: request

	| catalog |
	catalog _ tusLibrosSystem catalog.
	
	request send200Response: (WebUtils jsonEncode: catalog asArray)! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:37:52' prior: 50983211!
handleCatalog: request

	| catalog |
	catalog _ tusLibrosSystem catalog.

	request send200Response: (WebUtils jsonEncode: catalog asArray)! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:38:06' prior: 50983022!
initializeOn: aPortNumber
	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'HAW' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self addService: '/catalog' 
		withErrorSafeAction: [ :request | self handleCatalog: request ].
	
	self addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].

	self addService: '/listPurchases'
		withErrorSafeAction: [ :request | self handleListPurchases: request ].

	self addService: '/checkout'
		withErrorSafeAction: [ :request | self handleCheckout: request. ].
		
	! !

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #CartTest #test02CartWithABookShouldNotBeEmpty stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #CartTest #test03CartIncludesBookAfterAdding stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #CartTest #test04CantAddBookNotIncludedInCatalog stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #CartTest #test05CartIncludesAllOccurrencesOfBookAfterAdding stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #CartTest #test06CantAddBookWithZeroQuantity stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #CartTest #test07CantAddBookWithNegativeQuantity stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #CheckoutTest #test01CannotCheckoutWithEmptyCart stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #CheckoutTest #test02CheckoutOfCartWithSingleItemReturnsReceiptOfItsPrice stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #CheckoutTest #test03CheckoutOfCartWithItemWithMultipleOcurrencesReturnsRecepitOfItsTotalPrice stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #CheckoutTest #test04CheckoutOfCartWithMultipleItemsReturnsReceiptWithASumOfTheirPrices stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #CheckoutTest #test05CannotCheckoutWithExpiredCard stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #CheckoutTest #test06CannotCheckoutWithInvalidNumberCard stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #CheckoutTest #test07CannotCheckoutWithCardWithoutFunds stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #CheckoutTest #test08CannotCheckoutWithStolenCard stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CannotCreateCartWithInvalidCredentials stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CartCreatedWithValidCredentialsIsEmpty stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03AddingMultipleOcurrencesOfAProductListsEachOne stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04AddingToACartDoesntAffectTheOthers stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CannotAddProductToCartWithInvalidId stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CannotListCartWithInvalidId stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07CannotCheckoutInvalidCartId stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CheckoutOfCartRegistersSales stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09CheckoutReturnsDifferentIdsEachTime stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CannotListExpiredCart stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CartsExpireOnlyAfterThirtyMinutes stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12ListingRefreshesCart stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CannotAddProductsToExpiredCart stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14CannotCheckoutExpiredCart stamp: 'MP 11/19/2021 00:38:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15AddingProductsRefreshesCart stamp: 'MP 11/19/2021 00:38:35'!
PASSED!
!TusLibrosSystemFacadeTest methodsFor: 'tests' stamp: 'MP 11/19/2021 00:39:00'!
test16

	| tusLibros clock cartId |
	
	clock _ ManualClock new.
	tusLibros _ self tusLibrosSystemFacadeWithClock: clock.
	
	cartId _ tusLibros
		createCartFor: testObjectFactory defaultUser
		authenticatedBy: testObjectFactory defaultPassword. 

	clock incrementTimeBy: 15.

	tusLibros add: 1 of: testObjectFactory firstProductSoldByTheStore to: cartId.

	clock incrementTimeBy: 16.

	self shouldnt: [ tusLibros listCart: cartId ] raise: Error.

! !
!TusLibrosSystemFacadeTest methodsFor: 'tests' stamp: 'MP 11/19/2021 00:39:43' prior: 50983375!
test16

	| tusLibros expectedCatalog |

	tusLibros _ self defaultTusLibrosSystemFacade.

	expectedCatalog _ OrderedCollection new.
	self assert: expectedCatalog equals: tusLibros catalog.

! !

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'MP 11/19/2021 00:39:49'!
ERROR!
!TusLibrosSystemFacade methodsFor: 'rest interface' stamp: 'MP 11/19/2021 00:39:59'!
catalog
	self shouldBeImplemented.
	^catalog! !
!TusLibrosSystemFacade methodsFor: 'rest interface' stamp: 'MP 11/19/2021 00:40:05' prior: 50983405!
catalog

	^ catalog! !

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'MP 11/19/2021 00:40:07'!
FAILURE!
!TusLibrosSystemFacade methodsFor: 'rest interface' stamp: 'MP 11/19/2021 00:43:06' prior: 50983410!
catalog

	^ catalog keys.! !

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'MP 11/19/2021 00:43:45'!
FAILURE!
!TusLibrosSystemFacadeTest methodsFor: 'tests' stamp: 'MP 11/19/2021 00:43:59' prior: 50983393!
test16

	| tusLibros expectedCatalog |

	tusLibros _ self defaultTusLibrosSystemFacade.

	expectedCatalog _ OrderedCollection
		with: testObjectFactory firstProductSoldByTheStore.
	self assert: expectedCatalog equals: tusLibros catalog.

! !
!TusLibrosSystemFacadeTest methodsFor: 'tests' stamp: 'MP 11/19/2021 00:44:07' prior: 50983424!
test16

	| tusLibros expectedCatalog |

	tusLibros _ self defaultTusLibrosSystemFacade.

	expectedCatalog _ OrderedCollection
		with: testObjectFactory firstProductSoldByTheStore
		with: testObjectFactory secondProductSoldByTheStore.
	self assert: expectedCatalog equals: tusLibros catalog.

! !

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'MP 11/19/2021 00:44:09'!
FAILURE!
!TusLibrosSystemFacade methodsFor: 'rest interface' stamp: 'MP 11/19/2021 00:44:33' prior: 50983417!
catalog

	^ catalog keys asOrderedCollection .! !
!TusLibrosSystemFacade methodsFor: 'rest interface' stamp: 'MP 11/19/2021 00:44:34' prior: 50983451!
catalog

	^ catalog keys asOrderedCollection.! !

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #CartTest #test02CartWithABookShouldNotBeEmpty stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #CartTest #test03CartIncludesBookAfterAdding stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #CartTest #test04CantAddBookNotIncludedInCatalog stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #CartTest #test05CartIncludesAllOccurrencesOfBookAfterAdding stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #CartTest #test06CantAddBookWithZeroQuantity stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #CartTest #test07CantAddBookWithNegativeQuantity stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #CheckoutTest #test01CannotCheckoutWithEmptyCart stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #CheckoutTest #test02CheckoutOfCartWithSingleItemReturnsReceiptOfItsPrice stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #CheckoutTest #test03CheckoutOfCartWithItemWithMultipleOcurrencesReturnsRecepitOfItsTotalPrice stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #CheckoutTest #test04CheckoutOfCartWithMultipleItemsReturnsReceiptWithASumOfTheirPrices stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #CheckoutTest #test05CannotCheckoutWithExpiredCard stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #CheckoutTest #test06CannotCheckoutWithInvalidNumberCard stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #CheckoutTest #test07CannotCheckoutWithCardWithoutFunds stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #CheckoutTest #test08CannotCheckoutWithStolenCard stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CannotCreateCartWithInvalidCredentials stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CartCreatedWithValidCredentialsIsEmpty stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03AddingMultipleOcurrencesOfAProductListsEachOne stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04AddingToACartDoesntAffectTheOthers stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CannotAddProductToCartWithInvalidId stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CannotListCartWithInvalidId stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07CannotCheckoutInvalidCartId stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CheckoutOfCartRegistersSales stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09CheckoutReturnsDifferentIdsEachTime stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CannotListExpiredCart stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CartsExpireOnlyAfterThirtyMinutes stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12ListingRefreshesCart stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CannotAddProductsToExpiredCart stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14CannotCheckoutExpiredCart stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15AddingProductsRefreshesCart stamp: 'MP 11/19/2021 00:44:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'MP 11/19/2021 00:44:35'!
PASSED!
!TusLibrosSystemFacadeTest methodsFor: 'tests' stamp: 'MP 11/19/2021 00:44:42' prior: 50983435!
test16

	| tusLibros expectedCatalog |

	tusLibros _ self defaultTusLibrosSystemFacade.

	expectedCatalog _ OrderedCollection
		with: testObjectFactory firstProductSoldByTheStore
		with: testObjectFactory secondProductSoldByTheStore.
	
	self assert: expectedCatalog equals: tusLibros catalog.

! !
!TusLibrosSystemFacadeTest methodsFor: 'tests' stamp: 'MP 11/19/2021 00:44:43' prior: 50983570!
test16

	| tusLibros expectedCatalog |

	tusLibros _ self defaultTusLibrosSystemFacade.

	expectedCatalog _ OrderedCollection
		with: testObjectFactory firstProductSoldByTheStore
		with: testObjectFactory secondProductSoldByTheStore.

	self assert: expectedCatalog equals: tusLibros catalog.

! !

TusLibrosRestApiXXX cleanUpAndListenOn: 8080.!

TusLibrosLoginWindow open.!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:48:00' prior: 50983200!
catalogRequest

	| resp |

	resp _ WebClient httpGet: (self url, '/catalog').

	resp isSuccess 
		ifTrue: [^ (WebUtils jsonDecode: resp content readStream) asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !

!classDefinition: #Book category: 'TusLibros' stamp: 'MP 11/19/2021 00:50:17'!
Object subclass: #Book
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TestObjectFactory methodsFor: 'products' stamp: 'MP 11/19/2021 00:50:12' prior: 50974833!
firstProductSoldByTheStore

	^ Book named: '123' isbn: '123'.
! !
!TestObjectFactory methodsFor: 'products' stamp: 'MP 11/19/2021 00:50:36' prior: 50974842!
productNotSoldByTheStore

	^ Book named: 'El Cormen.' isbn: '2'.
! !
!TestObjectFactory methodsFor: 'products' stamp: 'MP 11/19/2021 00:50:38' prior: 50983615!
firstProductSoldByTheStore

	^ Book named: '123' isbn: '1'.
! !
!TestObjectFactory methodsFor: 'products' stamp: 'MP 11/19/2021 00:50:47' prior: 50974846!
secondProductSoldByTheStore

	^ Book named: 'The Bible' isbn: '3'.
! !

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #CartTest #test02CartWithABookShouldNotBeEmpty stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #CartTest #test03CartIncludesBookAfterAdding stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #CartTest #test04CantAddBookNotIncludedInCatalog stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #CartTest #test05CartIncludesAllOccurrencesOfBookAfterAdding stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #CartTest #test06CantAddBookWithZeroQuantity stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #CartTest #test07CantAddBookWithNegativeQuantity stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #CheckoutTest #test01CannotCheckoutWithEmptyCart stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #CheckoutTest #test02CheckoutOfCartWithSingleItemReturnsReceiptOfItsPrice stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #CheckoutTest #test03CheckoutOfCartWithItemWithMultipleOcurrencesReturnsRecepitOfItsTotalPrice stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #CheckoutTest #test04CheckoutOfCartWithMultipleItemsReturnsReceiptWithASumOfTheirPrices stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #CheckoutTest #test05CannotCheckoutWithExpiredCard stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #CheckoutTest #test06CannotCheckoutWithInvalidNumberCard stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #CheckoutTest #test07CannotCheckoutWithCardWithoutFunds stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #CheckoutTest #test08CannotCheckoutWithStolenCard stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test01CannotCreateCartWithInvalidCredentials stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test02CartCreatedWithValidCredentialsIsEmpty stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test03AddingMultipleOcurrencesOfAProductListsEachOne stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test04AddingToACartDoesntAffectTheOthers stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test05CannotAddProductToCartWithInvalidId stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test06CannotListCartWithInvalidId stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test07CannotCheckoutInvalidCartId stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test08CheckoutOfCartRegistersSales stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test09CheckoutReturnsDifferentIdsEachTime stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test10CannotListExpiredCart stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test11CartsExpireOnlyAfterThirtyMinutes stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test12ListingRefreshesCart stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test13CannotAddProductsToExpiredCart stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test14CannotCheckoutExpiredCart stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test15AddingProductsRefreshesCart stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'MP 11/19/2021 00:50:54'!
ERROR!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'MP 11/19/2021 00:50:56'!
ERROR!
!Book class methodsFor: 'instance creation' stamp: 'MP 11/19/2021 00:51:06'!
named: aString isbn: aString2 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeNamed: aString isbn: aString2 ! !
!Book class methodsFor: 'instance creation' stamp: 'MP 11/19/2021 00:51:09' prior: 50983746!
named: aString isbn: aString2 

	^self new initializeNamed: aString isbn: aString2 ! !
!Book class methodsFor: 'instance creation' stamp: 'MP 11/19/2021 00:51:31' prior: 50983755!
named: aTitle isbn: anISBN 

	^self new initializeNamed: aTitle isbn: anISBN ! !

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'MP 11/19/2021 00:51:32'!
ERROR!

!classDefinition: #Book category: 'TusLibros' stamp: 'MP 11/19/2021 00:51:41'!
Object subclass: #Book
	instanceVariableNames: 'title'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Book category: 'TusLibros' stamp: 'MP 11/19/2021 00:51:41'!
Object subclass: #Book
	instanceVariableNames: 'title iSBN'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Book methodsFor: 'initialization' stamp: 'MP 11/19/2021 00:51:41'!
initializeNamed: aTitle isbn: anISBN 
	self shouldBeImplemented.
	title := aTitle.
	iSBN := anISBN.! !
!Book methodsFor: 'initialization' stamp: 'MP 11/19/2021 00:51:43' prior: 50983782!
initializeNamed: aTitle isbn: anISBN 
	title := aTitle.
	iSBN := anISBN.! !
!Book methodsFor: 'initialization' stamp: 'MP 11/19/2021 00:51:44' prior: 50983788!
initializeNamed: aTitle isbn: anISBN 

	title := aTitle.
	iSBN := anISBN.! !

!classDefinition: #Book category: 'TusLibros' stamp: 'MP 11/19/2021 00:51:49'!
Object subclass: #Book
	instanceVariableNames: 'title isbn'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Book methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:51:49' prior: 50983793!
initializeNamed: aTitle isbn: anISBN 

	title := aTitle.
	isbn := anISBN.! !
!Book methodsFor: 'initialization' stamp: 'MP 11/19/2021 00:51:54' prior: 50983805!
initializeNamed: aTitle isbn: anISBN 

	title _ aTitle.
	isbn _ anISBN.! !
!Book methodsFor: 'initialization' stamp: 'MP 11/19/2021 00:52:05'!
initializeTitled: aTitle isbn: anISBN 

	title _ aTitle.
	isbn _ anISBN.! !
!Book class methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:52:05' prior: 50983761!
named: aTitle isbn: anISBN 

	^self new initializeTitled: aTitle isbn: anISBN ! !

!methodRemoval: Book #initializeNamed:isbn: stamp: 'MP 11/19/2021 00:52:05'!
initializeNamed: aTitle isbn: anISBN 

	title _ aTitle.
	isbn _ anISBN.!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'MP 11/19/2021 00:52:11'!
PASSED!

!testRun: #CartTest #test02CartWithABookShouldNotBeEmpty stamp: 'MP 11/19/2021 00:52:11'!
ERROR!

!testRun: #CartTest #test03CartIncludesBookAfterAdding stamp: 'MP 11/19/2021 00:52:11'!
ERROR!

!testRun: #CartTest #test04CantAddBookNotIncludedInCatalog stamp: 'MP 11/19/2021 00:52:11'!
PASSED!

!testRun: #CartTest #test05CartIncludesAllOccurrencesOfBookAfterAdding stamp: 'MP 11/19/2021 00:52:11'!
ERROR!

!testRun: #CartTest #test06CantAddBookWithZeroQuantity stamp: 'MP 11/19/2021 00:52:11'!
FAILURE!

!testRun: #CartTest #test07CantAddBookWithNegativeQuantity stamp: 'MP 11/19/2021 00:52:11'!
FAILURE!

!testRun: #CheckoutTest #test01CannotCheckoutWithEmptyCart stamp: 'MP 11/19/2021 00:52:11'!
PASSED!

!testRun: #CheckoutTest #test02CheckoutOfCartWithSingleItemReturnsReceiptOfItsPrice stamp: 'MP 11/19/2021 00:52:11'!
ERROR!

!testRun: #CheckoutTest #test03CheckoutOfCartWithItemWithMultipleOcurrencesReturnsRecepitOfItsTotalPrice stamp: 'MP 11/19/2021 00:52:11'!
ERROR!

!testRun: #CheckoutTest #test04CheckoutOfCartWithMultipleItemsReturnsReceiptWithASumOfTheirPrices stamp: 'MP 11/19/2021 00:52:11'!
ERROR!

!testRun: #CheckoutTest #test05CannotCheckoutWithExpiredCard stamp: 'MP 11/19/2021 00:52:11'!
ERROR!

!testRun: #CheckoutTest #test06CannotCheckoutWithInvalidNumberCard stamp: 'MP 11/19/2021 00:52:11'!
ERROR!

!testRun: #CheckoutTest #test07CannotCheckoutWithCardWithoutFunds stamp: 'MP 11/19/2021 00:52:11'!
ERROR!

!testRun: #CheckoutTest #test08CannotCheckoutWithStolenCard stamp: 'MP 11/19/2021 00:52:11'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test01CannotCreateCartWithInvalidCredentials stamp: 'MP 11/19/2021 00:52:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CartCreatedWithValidCredentialsIsEmpty stamp: 'MP 11/19/2021 00:52:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03AddingMultipleOcurrencesOfAProductListsEachOne stamp: 'MP 11/19/2021 00:52:11'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test04AddingToACartDoesntAffectTheOthers stamp: 'MP 11/19/2021 00:52:11'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test05CannotAddProductToCartWithInvalidId stamp: 'MP 11/19/2021 00:52:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CannotListCartWithInvalidId stamp: 'MP 11/19/2021 00:52:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07CannotCheckoutInvalidCartId stamp: 'MP 11/19/2021 00:52:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CheckoutOfCartRegistersSales stamp: 'MP 11/19/2021 00:52:11'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test09CheckoutReturnsDifferentIdsEachTime stamp: 'MP 11/19/2021 00:52:11'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test10CannotListExpiredCart stamp: 'MP 11/19/2021 00:52:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CartsExpireOnlyAfterThirtyMinutes stamp: 'MP 11/19/2021 00:52:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12ListingRefreshesCart stamp: 'MP 11/19/2021 00:52:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CannotAddProductsToExpiredCart stamp: 'MP 11/19/2021 00:52:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14CannotCheckoutExpiredCart stamp: 'MP 11/19/2021 00:52:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15AddingProductsRefreshesCart stamp: 'MP 11/19/2021 00:52:11'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'MP 11/19/2021 00:52:11'!
FAILURE!
!Book class methodsFor: 'instance creation' stamp: 'MP 11/19/2021 00:52:30'!
titled: aTitle isbn: anISBN 

	^self new initializeTitled: aTitle isbn: anISBN ! !
!TestObjectFactory methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:52:30' prior: 50983620!
productNotSoldByTheStore

	^ Book titled: 'El Cormen.' isbn: '2'.
! !
!TestObjectFactory methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:52:30' prior: 50983630!
secondProductSoldByTheStore

	^ Book titled: 'The Bible' isbn: '3'.
! !
!TestObjectFactory methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:52:30' prior: 50983625!
firstProductSoldByTheStore

	^ Book titled: '123' isbn: '1'.
! !

!methodRemoval: Book class #named:isbn: stamp: 'MP 11/19/2021 00:52:30'!
named: aTitle isbn: anISBN 

	^self new initializeTitled: aTitle isbn: anISBN !

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'MP 11/19/2021 00:52:33'!
PASSED!

!testRun: #CartTest #test02CartWithABookShouldNotBeEmpty stamp: 'MP 11/19/2021 00:52:33'!
ERROR!

!testRun: #CartTest #test03CartIncludesBookAfterAdding stamp: 'MP 11/19/2021 00:52:33'!
ERROR!

!testRun: #CartTest #test04CantAddBookNotIncludedInCatalog stamp: 'MP 11/19/2021 00:52:33'!
PASSED!

!testRun: #CartTest #test05CartIncludesAllOccurrencesOfBookAfterAdding stamp: 'MP 11/19/2021 00:52:33'!
ERROR!

!testRun: #CartTest #test06CantAddBookWithZeroQuantity stamp: 'MP 11/19/2021 00:52:33'!
FAILURE!

!testRun: #CartTest #test07CantAddBookWithNegativeQuantity stamp: 'MP 11/19/2021 00:52:33'!
FAILURE!

!testRun: #CheckoutTest #test01CannotCheckoutWithEmptyCart stamp: 'MP 11/19/2021 00:52:33'!
PASSED!

!testRun: #CheckoutTest #test02CheckoutOfCartWithSingleItemReturnsReceiptOfItsPrice stamp: 'MP 11/19/2021 00:52:33'!
ERROR!

!testRun: #CheckoutTest #test03CheckoutOfCartWithItemWithMultipleOcurrencesReturnsRecepitOfItsTotalPrice stamp: 'MP 11/19/2021 00:52:33'!
ERROR!

!testRun: #CheckoutTest #test04CheckoutOfCartWithMultipleItemsReturnsReceiptWithASumOfTheirPrices stamp: 'MP 11/19/2021 00:52:33'!
ERROR!

!testRun: #CheckoutTest #test05CannotCheckoutWithExpiredCard stamp: 'MP 11/19/2021 00:52:33'!
ERROR!

!testRun: #CheckoutTest #test06CannotCheckoutWithInvalidNumberCard stamp: 'MP 11/19/2021 00:52:33'!
ERROR!

!testRun: #CheckoutTest #test07CannotCheckoutWithCardWithoutFunds stamp: 'MP 11/19/2021 00:52:33'!
ERROR!

!testRun: #CheckoutTest #test08CannotCheckoutWithStolenCard stamp: 'MP 11/19/2021 00:52:33'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test01CannotCreateCartWithInvalidCredentials stamp: 'MP 11/19/2021 00:52:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CartCreatedWithValidCredentialsIsEmpty stamp: 'MP 11/19/2021 00:52:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03AddingMultipleOcurrencesOfAProductListsEachOne stamp: 'MP 11/19/2021 00:52:33'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test04AddingToACartDoesntAffectTheOthers stamp: 'MP 11/19/2021 00:52:33'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test05CannotAddProductToCartWithInvalidId stamp: 'MP 11/19/2021 00:52:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CannotListCartWithInvalidId stamp: 'MP 11/19/2021 00:52:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07CannotCheckoutInvalidCartId stamp: 'MP 11/19/2021 00:52:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CheckoutOfCartRegistersSales stamp: 'MP 11/19/2021 00:52:33'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test09CheckoutReturnsDifferentIdsEachTime stamp: 'MP 11/19/2021 00:52:33'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test10CannotListExpiredCart stamp: 'MP 11/19/2021 00:52:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CartsExpireOnlyAfterThirtyMinutes stamp: 'MP 11/19/2021 00:52:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12ListingRefreshesCart stamp: 'MP 11/19/2021 00:52:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CannotAddProductsToExpiredCart stamp: 'MP 11/19/2021 00:52:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14CannotCheckoutExpiredCart stamp: 'MP 11/19/2021 00:52:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15AddingProductsRefreshesCart stamp: 'MP 11/19/2021 00:52:33'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'MP 11/19/2021 00:52:33'!
FAILURE!

!testRun: #CartTest #test02CartWithABookShouldNotBeEmpty stamp: 'MP 11/19/2021 00:52:36'!
ERROR!

TestObjectFactory new.!

self defaultCatalog!

self keys!
!Book methodsFor: 'nil' stamp: 'MP 11/19/2021 00:54:44' overrides: 50758320!
= otherBook

	^ title = otherBook title and: [ isbn = otherBook isbn ].

	! !
!Book methodsFor: 'accessing' stamp: 'MP 11/19/2021 00:55:20'!
title

	^ title.! !
!Book methodsFor: 'accessing' stamp: 'MP 11/19/2021 00:55:24'!
isbn

	^ isbn.! !

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'MP 11/19/2021 00:55:25'!
PASSED!

!testRun: #CartTest #test02CartWithABookShouldNotBeEmpty stamp: 'MP 11/19/2021 00:55:25'!
ERROR!

!testRun: #CartTest #test03CartIncludesBookAfterAdding stamp: 'MP 11/19/2021 00:55:25'!
FAILURE!

!testRun: #CartTest #test04CantAddBookNotIncludedInCatalog stamp: 'MP 11/19/2021 00:55:25'!
PASSED!

!testRun: #CartTest #test05CartIncludesAllOccurrencesOfBookAfterAdding stamp: 'MP 11/19/2021 00:55:25'!
ERROR!

!testRun: #CartTest #test06CantAddBookWithZeroQuantity stamp: 'MP 11/19/2021 00:55:25'!
FAILURE!

!testRun: #CartTest #test07CantAddBookWithNegativeQuantity stamp: 'MP 11/19/2021 00:55:25'!
FAILURE!

!testRun: #CheckoutTest #test01CannotCheckoutWithEmptyCart stamp: 'MP 11/19/2021 00:55:25'!
PASSED!

!testRun: #CheckoutTest #test02CheckoutOfCartWithSingleItemReturnsReceiptOfItsPrice stamp: 'MP 11/19/2021 00:55:25'!
ERROR!

!testRun: #CheckoutTest #test03CheckoutOfCartWithItemWithMultipleOcurrencesReturnsRecepitOfItsTotalPrice stamp: 'MP 11/19/2021 00:55:25'!
ERROR!

!testRun: #CheckoutTest #test04CheckoutOfCartWithMultipleItemsReturnsReceiptWithASumOfTheirPrices stamp: 'MP 11/19/2021 00:55:25'!
ERROR!

!testRun: #CheckoutTest #test05CannotCheckoutWithExpiredCard stamp: 'MP 11/19/2021 00:55:25'!
ERROR!

!testRun: #CheckoutTest #test06CannotCheckoutWithInvalidNumberCard stamp: 'MP 11/19/2021 00:55:25'!
ERROR!

!testRun: #CheckoutTest #test07CannotCheckoutWithCardWithoutFunds stamp: 'MP 11/19/2021 00:55:25'!
ERROR!

!testRun: #CheckoutTest #test08CannotCheckoutWithStolenCard stamp: 'MP 11/19/2021 00:55:25'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test01CannotCreateCartWithInvalidCredentials stamp: 'MP 11/19/2021 00:55:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CartCreatedWithValidCredentialsIsEmpty stamp: 'MP 11/19/2021 00:55:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03AddingMultipleOcurrencesOfAProductListsEachOne stamp: 'MP 11/19/2021 00:55:25'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test04AddingToACartDoesntAffectTheOthers stamp: 'MP 11/19/2021 00:55:25'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test05CannotAddProductToCartWithInvalidId stamp: 'MP 11/19/2021 00:55:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CannotListCartWithInvalidId stamp: 'MP 11/19/2021 00:55:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07CannotCheckoutInvalidCartId stamp: 'MP 11/19/2021 00:55:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CheckoutOfCartRegistersSales stamp: 'MP 11/19/2021 00:55:25'!
FAILURE!

!testRun: #TusLibrosSystemFacadeTest #test09CheckoutReturnsDifferentIdsEachTime stamp: 'MP 11/19/2021 00:55:25'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test10CannotListExpiredCart stamp: 'MP 11/19/2021 00:55:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CartsExpireOnlyAfterThirtyMinutes stamp: 'MP 11/19/2021 00:55:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12ListingRefreshesCart stamp: 'MP 11/19/2021 00:55:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CannotAddProductsToExpiredCart stamp: 'MP 11/19/2021 00:55:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14CannotCheckoutExpiredCart stamp: 'MP 11/19/2021 00:55:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15AddingProductsRefreshesCart stamp: 'MP 11/19/2021 00:55:25'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'MP 11/19/2021 00:55:25'!
PASSED!

!testRun: #CartTest #test02CartWithABookShouldNotBeEmpty stamp: 'MP 11/19/2021 00:55:27'!
ERROR!

self keys!

anObject hash!
!Book methodsFor: 'nil' stamp: 'MP 11/19/2021 00:58:53' overrides: 16881101!
asString

	^title, isbn! !
!Book methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:59:00' overrides: 50762273!
hash

	^self asString.! !

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #CartTest #test02CartWithABookShouldNotBeEmpty stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #CartTest #test03CartIncludesBookAfterAdding stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #CartTest #test04CantAddBookNotIncludedInCatalog stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #CartTest #test05CartIncludesAllOccurrencesOfBookAfterAdding stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #CartTest #test06CantAddBookWithZeroQuantity stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #CartTest #test07CantAddBookWithNegativeQuantity stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #CheckoutTest #test01CannotCheckoutWithEmptyCart stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #CheckoutTest #test02CheckoutOfCartWithSingleItemReturnsReceiptOfItsPrice stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #CheckoutTest #test03CheckoutOfCartWithItemWithMultipleOcurrencesReturnsRecepitOfItsTotalPrice stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #CheckoutTest #test04CheckoutOfCartWithMultipleItemsReturnsReceiptWithASumOfTheirPrices stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #CheckoutTest #test05CannotCheckoutWithExpiredCard stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #CheckoutTest #test06CannotCheckoutWithInvalidNumberCard stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #CheckoutTest #test07CannotCheckoutWithCardWithoutFunds stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #CheckoutTest #test08CannotCheckoutWithStolenCard stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test01CannotCreateCartWithInvalidCredentials stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test02CartCreatedWithValidCredentialsIsEmpty stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test03AddingMultipleOcurrencesOfAProductListsEachOne stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test04AddingToACartDoesntAffectTheOthers stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test05CannotAddProductToCartWithInvalidId stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test06CannotListCartWithInvalidId stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test07CannotCheckoutInvalidCartId stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test08CheckoutOfCartRegistersSales stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test09CheckoutReturnsDifferentIdsEachTime stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test10CannotListExpiredCart stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test11CartsExpireOnlyAfterThirtyMinutes stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test12ListingRefreshesCart stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test13CannotAddProductsToExpiredCart stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test14CannotCheckoutExpiredCart stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test15AddingProductsRefreshesCart stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'MP 11/19/2021 00:59:03'!
ERROR!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'MP 11/19/2021 00:59:08'!
ERROR!
!Book methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:59:27' prior: 50984210 overrides: 50762273!
hash

	^self asString asNumber.! !
!Book methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 00:59:34' prior: 50984325 overrides: 50762273!
hash

	^ self asString asNumber.! !

'hola' asNumber!

'hola' hash!

'hola' hash !

'hola' hash!
!Book methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:01:09' prior: 50984330 overrides: 50762273!
hash

	^ self asString hash.! !

(Book titled: 'pepe' isbn: '1') hash!

(Book titled: 'pepe' isbn: '1') hash !

(Book titled: 'pepe' isbn: '1') hash!
!Book methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:02:52'!
hash2

	^ self asString hash.! !
!Book methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:02:52' prior: 50984337 overrides: 50762273!
hash

	^ self asString hash2.! !
!Book methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:02:52' prior: 50984344!
hash2

	^ self asString hash2.! !

!methodRemoval: Book #hash stamp: 'MP 11/19/2021 01:02:52'!
hash

	^ self asString hash2.!

(Book titled: 'pepe' isbn: '1') hash !

(Book titled: 'pepe' isbn: '1') hash !

(Book titled: 'pepe' isbn: '1') hash!
!Book methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:03:13' prior: 50984353!
hash2

	^ self asString hash2.! !
!Book methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:03:30' overrides: 50762273!
hash

	^ self asString hash2.! !
!Book methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:03:30' prior: 50984364!
hash2

	^ self asString hash.! !
!Book methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:03:30' prior: 50984368 overrides: 50762273!
hash

	^ self asString hash.! !

!methodRemoval: Book #hash2 stamp: 'MP 11/19/2021 01:03:30'!
hash2

	^ self asString hash.!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #CartTest #test02CartWithABookShouldNotBeEmpty stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #CartTest #test03CartIncludesBookAfterAdding stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #CartTest #test04CantAddBookNotIncludedInCatalog stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #CartTest #test05CartIncludesAllOccurrencesOfBookAfterAdding stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #CartTest #test06CantAddBookWithZeroQuantity stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #CartTest #test07CantAddBookWithNegativeQuantity stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #CheckoutTest #test01CannotCheckoutWithEmptyCart stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #CheckoutTest #test02CheckoutOfCartWithSingleItemReturnsReceiptOfItsPrice stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #CheckoutTest #test03CheckoutOfCartWithItemWithMultipleOcurrencesReturnsRecepitOfItsTotalPrice stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #CheckoutTest #test04CheckoutOfCartWithMultipleItemsReturnsReceiptWithASumOfTheirPrices stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #CheckoutTest #test05CannotCheckoutWithExpiredCard stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #CheckoutTest #test06CannotCheckoutWithInvalidNumberCard stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #CheckoutTest #test07CannotCheckoutWithCardWithoutFunds stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #CheckoutTest #test08CannotCheckoutWithStolenCard stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CannotCreateCartWithInvalidCredentials stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CartCreatedWithValidCredentialsIsEmpty stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03AddingMultipleOcurrencesOfAProductListsEachOne stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04AddingToACartDoesntAffectTheOthers stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CannotAddProductToCartWithInvalidId stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CannotListCartWithInvalidId stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07CannotCheckoutInvalidCartId stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CheckoutOfCartRegistersSales stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09CheckoutReturnsDifferentIdsEachTime stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CannotListExpiredCart stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CartsExpireOnlyAfterThirtyMinutes stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12ListingRefreshesCart stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CannotAddProductsToExpiredCart stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14CannotCheckoutExpiredCart stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15AddingProductsRefreshesCart stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'MP 11/19/2021 01:03:35'!
PASSED!

TusLibrosLoginWindow open.!

TusLibrosRestApiXXX cleanUpAndListenOn: 8080.!

TusLibrosLoginWindow open.!

resp content!

tof _ TestObjectFactory new.!

tof firstProductSoldByTheStore!

tof firstProductSoldByTheStore asDictionary!
!WebUtils class methodsFor: 'json-encode' stamp: 'MP 11/19/2021 01:15:09' prior: 50959690!
jsonObj: anObject on: stream
	"Encode a generic object"

	anObject isString ifTrue:[^self jsonString: anObject on: stream].
	anObject isNumber ifTrue:[^self jsonNumber: anObject on: stream].
	anObject == nil ifTrue:[^stream nextPutAll: 'null'].
	anObject == true ifTrue:[^stream nextPutAll: 'true'].
	anObject == false ifTrue:[^stream nextPutAll: 'false'].
	anObject isArray ifTrue:[^self jsonArray: anObject on: stream].
	(anObject is: #Dictionary) ifTrue:[^self jsonMap: anObject on: stream].

	self error: 'Cannot encode: ', anObject! !

!classDefinition: #TusLibrosEncoder category: 'TusLibros' stamp: 'MP 11/19/2021 01:17:29'!
Object subclass: #TusLibrosEncoder
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:17:27' prior: 50983219!
handleCatalog: request

	| catalog |
	catalog _ tusLibrosSystem catalog.

	request send200Response: (TusLibrosEncoder encodeCatalog: catalog)! !
!TusLibrosEncoder methodsFor: 'no messages' stamp: 'MP 11/19/2021 01:19:13'!
encodeCatalog: aCatalog

	| catalogWithEncodedBooks |
	catalogWithEncodedBooks _ 
		aCatalog collect: [ :aBook | self encodeBook: aBook ].
	
	^ WebUtils jsonEncode: catalogWithEncodedBooks.

	! !

{ 1. 2. 3 } collect: [ :e | e asString ]!
!TusLibrosEncoder methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:20:32'!
encodeBook: aBook

	^ Dictionary new
		at: 'isbn' put: aBook isbn;
		at: 'title' put: aBook title
		yourself.! !
!TusLibrosEncoder methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:21:13'!
decodeBook: anEncodedBook

	^ Book
		titled: (anEncodedBook at: 'title')
		isbn: (anEncodedBook at: 'isbn').! !
!TusLibrosEncoder methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:27:30'!
decodeCatalog: anEncodedCatalog

	| decodedCatalog |
	decodedCatalog _ WebUtils jsonDecode: anEncodedCatalog.
	^ decodedCatalog collect: [ :anEncodedBook | self decodeBook: anEncodedBook ].
	

	! !

TusLibrosEncoder encodeCatalog: tof defaultCatalog !
!TusLibrosEncoder class methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:28:11'!
decodeBook: anEncodedBook

	^ Book
		titled: (anEncodedBook at: 'title')
		isbn: (anEncodedBook at: 'isbn').! !

!methodRemoval: TusLibrosEncoder #decodeBook: stamp: 'MP 11/19/2021 01:28:11'!
decodeBook: anEncodedBook

	^ Book
		titled: (anEncodedBook at: 'title')
		isbn: (anEncodedBook at: 'isbn').!
!TusLibrosEncoder class methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:28:14'!
decodeCatalog: anEncodedCatalog

	| decodedCatalog |
	decodedCatalog _ WebUtils jsonDecode: anEncodedCatalog.
	^ decodedCatalog collect: [ :anEncodedBook | self decodeBook: anEncodedBook ].
	

	! !

!methodRemoval: TusLibrosEncoder #decodeCatalog: stamp: 'MP 11/19/2021 01:28:14'!
decodeCatalog: anEncodedCatalog

	| decodedCatalog |
	decodedCatalog _ WebUtils jsonDecode: anEncodedCatalog.
	^ decodedCatalog collect: [ :anEncodedBook | self decodeBook: anEncodedBook ].
	

	!
!TusLibrosEncoder class methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:28:19'!
encodeBook: aBook

	^ Dictionary new
		at: 'isbn' put: aBook isbn;
		at: 'title' put: aBook title
		yourself.! !

!methodRemoval: TusLibrosEncoder #encodeBook: stamp: 'MP 11/19/2021 01:28:19'!
encodeBook: aBook

	^ Dictionary new
		at: 'isbn' put: aBook isbn;
		at: 'title' put: aBook title
		yourself.!
!TusLibrosEncoder class methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:28:22'!
encodeCatalog: aCatalog

	| catalogWithEncodedBooks |
	catalogWithEncodedBooks _ 
		aCatalog collect: [ :aBook | self encodeBook: aBook ].
	
	^ WebUtils jsonEncode: catalogWithEncodedBooks.

	! !

!methodRemoval: TusLibrosEncoder #encodeCatalog: stamp: 'MP 11/19/2021 01:28:22'!
encodeCatalog: aCatalog

	| catalogWithEncodedBooks |
	catalogWithEncodedBooks _ 
		aCatalog collect: [ :aBook | self encodeBook: aBook ].
	
	^ WebUtils jsonEncode: catalogWithEncodedBooks.

	!

TusLibrosEncoder encodeCatalog: tof defaultCatalog !

TusLibrosEncoder encodeCatalog: tof defaultCatalog keys!

TusLibrosEncoder decodeCatalog: '["123", "The Bible"]'!

TusLibrosEncoder encodeCatalog: tof defaultCatalog keys.!

tof defaultCatalog keys!

TusLibrosEncoder encodeBook: tof firstProductSoldByTheStore .!
!TusLibrosEncoder class methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:31:28' prior: 50984602!
encodeBook: aBook

	| bookAsDict |
	bookAsDict _ Dictionary new
		at: 'isbn' put: aBook isbn;
		at: 'title' put: aBook title
		yourself.
	
	^ WebUtils jsonEncode: bookAsDict.! !
!TusLibrosEncoder class methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:31:38' prior: 50984644!
encodeBook: aBook

	^ Dictionary new
		at: 'isbn' put: aBook isbn;
		at: 'title' put: aBook title
		yourself.
	! !
!TusLibrosEncoder class methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:31:57' prior: 50984615!
encodeCatalog: aCatalog

	| catalogWithEncodedBooks |
	catalogWithEncodedBooks _ 
		aCatalog collect: [ :aBook | self encodeBook: aBook ].
	
	^ WebUtils jsonEncode: catalogWithEncodedBooks asArray.

	! !

TusLibrosEncoder encodeCatalog: tof defaultCatalog keys.!

TusLibrosEncoder encodeBook: tof firstProductSoldByTheStore .!

TusLibrosEncoder encodeBook: tof firstProductSoldByTheStore.!
!TusLibrosEncoder class methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:33:03' prior: 50984653!
encodeBook: aBook

	^ Dictionary new
		at: 'isbn' put: aBook isbn;
		at: 'title' put: aBook title;
		yourself.
	! !
!TusLibrosEncoder class methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:33:16' prior: 50984660!
encodeCatalog: aCatalog

	| catalogWithEncodedBooks |
	catalogWithEncodedBooks _ 
		aCatalog collect: [ :aBook | self encodeBook: aBook ].
	
	^ WebUtils jsonEncode: catalogWithEncodedBooks.

	! !

TusLibrosEncoder encodeBook: tof firstProductSoldByTheStore.!

TusLibrosEncoder encodeCatalog: tof defaultCatalog keys.!

TusLibrosEncoder decodeCatalog:  '[{"isbn": "1", "title": "123"}, {"isbn": "3", "title": "The Bible"}]' !

WebUtils jsonDecode: '[{"isbn": "1", "title": "123"}, {"isbn": "3", "title": "The Bible"}]' !

WebUtils jsonDecode: '[{"isbn": "1", "title": "123"}, {"isbn": "3", "title": "The Bible"}]' asByteArray !

WebUtils jsonDecode: '[{"isbn": "1", "title": "123"}, {"isbn": "3", "title": "The Bible"}]' readStream !

TusLibrosEncoder decodeCatalog:  '[{"isbn": "1", "title": "123"}, {"isbn": "3", "title": "The Bible"}]' readStream!

 #(a Book a Book) !

TusLibrosEncoder decodeCatalog:  '[{"isbn": "1", "title": "123"}, {"isbn": "3", "title": "The Bible"}]' readStream!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:35:43' prior: 50983598!
catalogRequest

	| resp |

	resp _ WebClient httpGet: (self url, '/catalog').

	resp isSuccess 
		ifTrue: [^ (TusLibrosEncoder decodeCatalog: resp content readStream) asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #CartTest #test02CartWithABookShouldNotBeEmpty stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #CartTest #test03CartIncludesBookAfterAdding stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #CartTest #test04CantAddBookNotIncludedInCatalog stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #CartTest #test05CartIncludesAllOccurrencesOfBookAfterAdding stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #CartTest #test06CantAddBookWithZeroQuantity stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #CartTest #test07CantAddBookWithNegativeQuantity stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #CheckoutTest #test01CannotCheckoutWithEmptyCart stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #CheckoutTest #test02CheckoutOfCartWithSingleItemReturnsReceiptOfItsPrice stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #CheckoutTest #test03CheckoutOfCartWithItemWithMultipleOcurrencesReturnsRecepitOfItsTotalPrice stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #CheckoutTest #test04CheckoutOfCartWithMultipleItemsReturnsReceiptWithASumOfTheirPrices stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #CheckoutTest #test05CannotCheckoutWithExpiredCard stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #CheckoutTest #test06CannotCheckoutWithInvalidNumberCard stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #CheckoutTest #test07CannotCheckoutWithCardWithoutFunds stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #CheckoutTest #test08CannotCheckoutWithStolenCard stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CannotCreateCartWithInvalidCredentials stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CartCreatedWithValidCredentialsIsEmpty stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03AddingMultipleOcurrencesOfAProductListsEachOne stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04AddingToACartDoesntAffectTheOthers stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CannotAddProductToCartWithInvalidId stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CannotListCartWithInvalidId stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07CannotCheckoutInvalidCartId stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CheckoutOfCartRegistersSales stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09CheckoutReturnsDifferentIdsEachTime stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CannotListExpiredCart stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CartsExpireOnlyAfterThirtyMinutes stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12ListingRefreshesCart stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CannotAddProductsToExpiredCart stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14CannotCheckoutExpiredCart stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15AddingProductsRefreshesCart stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'MP 11/19/2021 01:36:08'!
PASSED!

TusLibrosLoginWindow open.!
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:37:10' prior: 50984528!
handleCatalog: request

	| catalog |
	catalog _ tusLibrosSystem catalog.

	self halt.

	request send200Response: (TusLibrosEncoder encodeCatalog: catalog)! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:38:22' prior: 50984839!
handleCatalog: request

	| catalog |
	catalog _ tusLibrosSystem catalog.

	self halt.

	request send200Response: (TusLibrosEncoder encodeCatalog: catalog)! !
!TusLibrosEncoder class methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:38:38' prior: 50984683!
encodeCatalog: aCatalog

	| catalogWithEncodedBooks |
	catalogWithEncodedBooks _ 
		aCatalog collect: [ :aBook | self encodeBook: aBook ].
	
	^ WebUtils jsonEncode: catalogWithEncodedBooks.

	! !
!TusLibrosEncoder class methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:38:40' prior: 50984857!
encodeCatalog: aCatalog

	| catalogWithEncodedBooks |
	catalogWithEncodedBooks _ 
		aCatalog collect: [ :aBook | self encodeBook: aBook ].
	
	^ WebUtils jsonEncode: catalogWithEncodedBooks asArray.

	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:39:51' prior: 50984848!
handleCatalog: request

	| catalog |
	catalog _ tusLibrosSystem catalog.

	request send200Response: (TusLibrosEncoder encodeCatalog: catalog)! !

----SNAPSHOT----(19 November 2021 01:39:53) CuisUniversity-4972.image priorSource: 20849016!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:41:34' prior: 50983186!
catalog
	
	| aCatalog |
	aCatalog _ self catalogRequest.
	
	^ aCatalog collect: [ :aBook | aBook asString ].! !

TusLibrosLoginWindow open.!
!Book methodsFor: 'converting' stamp: 'MP 11/19/2021 01:42:28' prior: 50984206 overrides: 16881101!
asString

	^'(', isbn, ') ', title! !

TusLibrosLoginWindow open.!
!Book methodsFor: 'converting' stamp: 'MP 11/19/2021 01:43:09' prior: 50984896 overrides: 16881101!
asString

	^'( ISBN ', isbn, ') ', title! !

TusLibrosLoginWindow open.!
!Book methodsFor: 'converting' stamp: 'MP 11/19/2021 01:43:22' prior: 50984902 overrides: 16881101!
asString

	^'(ISBN ', isbn, ') ', title! !

TusLibrosLoginWindow open.!
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:43:38' prior: 50983227!
initializeOn: aPortNumber
	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'haw' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	webServer addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self addService: '/catalog' 
		withErrorSafeAction: [ :request | self handleCatalog: request ].
	
	self addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].

	self addService: '/listPurchases'
		withErrorSafeAction: [ :request | self handleListPurchases: request ].

	self addService: '/checkout'
		withErrorSafeAction: [ :request | self handleCheckout: request. ].
		
	! !

TusLibrosLoginWindow open.!

TusLibrosRestApiXXX cleanUpAndListenOn: 8080.!

TusLibrosLoginWindow open.!
!Book methodsFor: 'converting' stamp: 'MP 11/19/2021 01:45:04' prior: 50984908 overrides: 16881101!
asString

	^'(ISBN #', isbn, ') ', title! !
!Book methodsFor: 'converting' stamp: 'MP 11/19/2021 01:45:24' prior: 50984959 overrides: 16881101!
asString

	^isbn, ' ', title! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:45:52' prior: 50984888!
catalog
	
	| aCatalog |
	aCatalog _ self catalogRequest.
	
	^ aCatalog collect: [ :aBook | 	'(ISBN #', aBook isbn, ') ', aBook title ].! !

TusLibrosLoginWindow open.!

----SNAPSHOT----(19 November 2021 01:47:09) CuisUniversity-4972.image priorSource: 20903472!

----STARTUP---- (20 November 2021 00:45:10) as /home/trona/Facu/ing1/cuis-tus-libros-it4/CuisUniversity-4972.image!


TusLibrosRestApiXXX cleanUpAndListenOn: 8080.!

TusLibrosRestApiXXX cleanUpAndListenOn: 8080.!

TusLibrosLoginWindow open.!

TusLibrosLoginWindow open.!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 00:50:35' prior: 50983169 overrides: 16896425!
initialize

	username _ 'haw'.
	password _ 'hunter2'.
	catalogIndex _ 0.! !

TusLibrosLoginWindow open.!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 00:53:44'!
addToCart
	
	self addToCartRequest: nil at: catalogIndex.! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 00:54:04' prior: 50984997!
addToCart
	
	self addToCartRequest: (nil at: catalogIndex).! !

!classDefinition: #TusLibrosClientModel category: 'TusLibros' stamp: 'AF 11/20/2021 00:55:57'!
Object subclass: #TusLibrosClientModel
	instanceVariableNames: 'username password cartId catalogIndex catalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 00:55:55' prior: 50984969!
catalog
	
	catalog ifNotNil:[
		^catalog
	].
	catalog _ self catalogRequest.
	
	^ catalog collect: [ :aBook | 	'(ISBN #', aBook isbn, ') ', aBook title ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 00:56:10' prior: 50985017!
catalog
	
	catalog ifNotNil:[ ^catalog ].
	catalog _ self catalogRequest.
	
	^ catalog collect: [ :aBook | 	'(ISBN #', aBook isbn, ') ', aBook title ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 00:56:21' prior: 50985026!
catalog
	
	catalog ifNotNil:[ ^catalog ].
	
	catalog _ self catalogRequest.
	^ catalog collect: [ :aBook | 	'(ISBN #', aBook isbn, ') ', aBook title ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 00:56:47' prior: 50985003!
addToCart
	
	self addToCartRequest: (catalog at: catalogIndex).! !

TusLibrosLoginWindow open.!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 00:59:59' prior: 50984990 overrides: 16896425!
initialize

	username _ 'haw'.
	password _ 'hunter2'.
	catalogIndex _ 1.! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 01:03:19' prior: 50985044!
addToCart
	
	| selectedBookIsbn |
	selectedBookIsbn _ (catalog at: catalogIndex) isbn.
	self addToCartRequest: selectedBookIsbn.! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 01:03:40'!
addToCartRequest: aIsbn
	
	! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 01:05:03' prior: 50985064!
addToCartRequest: aIsbn
	
	| resp |

	resp _ WebClient httpGet: (self url, '/addProductToCart').

	resp isSuccess 
		ifTrue: [^ (TusLibrosEncoder decodeCatalog: resp content readStream) asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 01:07:41' prior: 50985069!
addToCartRequest: aIsbn
	
	| resp fields |

	fields _ Dictionary new 
		at: 'cartId' put: cartId;
		at: 'isbn' put: aIsbn ;
		at: 'quantity' put: '1';
		yourself.
	
	resp _ WebClient httpGet: (self url, '/addProductToCart').
	
	

	resp isSuccess 
		ifTrue: [^ (TusLibrosEncoder decodeCatalog: resp content readStream) asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 01:08:39' prior: 50985081!
addToCartRequest: aIsbn
	
	| resp fields |

	fields _ Dictionary new 
		at: 'cartId' put: cartId;
		at: 'isbn' put: aIsbn ;
		at: 'quantity' put: '1';
		yourself.
	
	resp _ WebClient httpPost: (self url, '/addProductToCart') .
	
	

	resp isSuccess 
		ifTrue: [^ (TusLibrosEncoder decodeCatalog: resp content readStream) asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 01:11:05' prior: 50985097!
addToCartRequest: aIsbn
	
	| resp fields |

	fields _ Dictionary new 
		at: 'cartId' put: cartId;
		at: 'isbn' put: aIsbn ;
		at: 'quantity' put: '1';
		yourself.
	
	resp _ WebClient htmlSubmit: (self url, '/addProductToCart') fields: fields .
	
	

	resp isSuccess 
		ifTrue: [^ (TusLibrosEncoder decodeCatalog: resp content readStream) asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 01:11:32' prior: 50985113!
addToCartRequest: aIsbn
	
	| resp fields |

	fields _ Dictionary new 
		at: 'cartId' put: cartId;
		at: 'isbn' put: aIsbn ;
		at: 'quantity' put: '1';
		yourself.
	
	resp _ WebClient htmlSubmit: (self url, '/addProductToCart') fields: fields.
	
	

	resp isSuccess 
		ifTrue: [^ (TusLibrosEncoder decodeCatalog: resp content readStream) asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 01:12:20' prior: 50985129!
addToCartRequest: aIsbn
	
	| resp fields |

	fields _ Dictionary new 
		at: 'cartId' put: cartId;
		at: 'isbn' put: aIsbn ;
		at: 'quantity' put: '1';
		yourself.
	
	resp _ WebClient htmlSubmit: (self url, '/addProductToCart') fields: fields.
	
	resp isSuccess 
		ifTrue: [^ 'ok' ] 
		ifFalse:[ ^ self error: resp content ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 01:19:55' prior: 50985145!
addToCartRequest: aIsbn
	
	| resp fields |

	fields _ Dictionary new 
		at: 'cartId' put: cartId;
		at: 'isbn' put: aIsbn ;
		at: 'quantity' put: '1';
		yourself.
	
	resp _ WebClient htmlSubmit: (self url, '/addProductToCart') fields: fields.
	
	resp isSuccess 
		ifTrue: [^ self ] 
		ifFalse:[ ^ self error: resp content ].! !

TusLibrosLoginWindow open.!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 01:22:17' prior: 50985057!
addToCart
	
	| selectedBookIsbn |
	self halt.
	selectedBookIsbn _ (catalog at: catalogIndex) isbn.
<<<<<<< HEAD
	self addToCartRequest: selectedBookIsbn.! !
=======
	self addToCartRequest: selectedBookIsbn.! !

----QUIT----(20 November 2021 01:38:06) CuisUniversity-4972.image priorSource: 20906439!

----STARTUP---- (20 November 2021 14:22:12) as /home/agus/Documents/inge1/cuis-tus-libros-it4/CuisUniversity-4972.image!


TusLibrosLoginWindow open.!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 14:29:12' prior: 50985174!
addToCart
	
	| selectedBookIsbn |
	
	selectedBookIsbn _ (catalog at: catalogIndex) isbn.
	self addToCartRequest: selectedBookIsbn.! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 14:29:49' prior: 50976338!
handleAddProductToCart: request

	| cartId isbn quantity |
	self halt.
	cartId _ (request fields at: 'cartId') asNumber.
	isbn _ request fields at: 'isbn'.
	quantity _ (request fields at: 'quantity') asNumber.

	tusLibrosSystem add: quantity of: isbn to: cartId.

	request send200Response: 'OK'! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 14:32:17' prior: 50985198!
handleAddProductToCart: request

	| cartId isbn quantity |
	
	cartId _ (request fields at: 'cartId') asNumber.
	isbn _ request fields at: 'isbn'.
	quantity _ (request fields at: 'quantity') asNumber.

	tusLibrosSystem add: quantity of: isbn to: cartId.

	request send200Response: 'OK'! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 14:33:18' prior: 50985159!
addToCartRequest: aIsbn
	
	| resp fields |

	fields _ Dictionary new 
		at: 'cartId' put: cartId;
		at: 'isbn' put: aIsbn ;
		at: 'quantity' put: '1';
		yourself.
	
	resp _ WebClient htmlSubmit: (self url, '/addProductToCart') fields: fields.
	
	resp isSuccess 
		ifTrue: [^ self ] 
		ifFalse:[ ^ self handleErrorResponse: resp ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 14:35:06'!
handleErrorResponse: aResponse

	TranscriptWindow openTranscript.
	Transcript show: aResponse contents.! !

TusLibrosLoginWindow open.!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 14:35:41' prior: 50985238!
handleErrorResponse: aResponse

	TranscriptWindow openTranscript.
	Transcript show: aResponse content.! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 14:36:01' prior: 50985246!
handleErrorResponse: aResponse

	TranscriptWindow openTranscript.
	Transcript clear. 
	Transcript show: aResponse content.! !

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #CartTest #test02CartWithABookShouldNotBeEmpty stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #CartTest #test03CartIncludesBookAfterAdding stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #CartTest #test04CantAddBookNotIncludedInCatalog stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #CartTest #test05CartIncludesAllOccurrencesOfBookAfterAdding stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #CartTest #test06CantAddBookWithZeroQuantity stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #CartTest #test07CantAddBookWithNegativeQuantity stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #CheckoutTest #test01CannotCheckoutWithEmptyCart stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #CheckoutTest #test02CheckoutOfCartWithSingleItemReturnsReceiptOfItsPrice stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #CheckoutTest #test03CheckoutOfCartWithItemWithMultipleOcurrencesReturnsRecepitOfItsTotalPrice stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #CheckoutTest #test04CheckoutOfCartWithMultipleItemsReturnsReceiptWithASumOfTheirPrices stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #CheckoutTest #test05CannotCheckoutWithExpiredCard stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #CheckoutTest #test06CannotCheckoutWithInvalidNumberCard stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #CheckoutTest #test07CannotCheckoutWithCardWithoutFunds stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #CheckoutTest #test08CannotCheckoutWithStolenCard stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CannotCreateCartWithInvalidCredentials stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CartCreatedWithValidCredentialsIsEmpty stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03AddingMultipleOcurrencesOfAProductListsEachOne stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04AddingToACartDoesntAffectTheOthers stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CannotAddProductToCartWithInvalidId stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CannotListCartWithInvalidId stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07CannotCheckoutInvalidCartId stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CheckoutOfCartRegistersSales stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09CheckoutReturnsDifferentIdsEachTime stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CannotListExpiredCart stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CartsExpireOnlyAfterThirtyMinutes stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12ListingRefreshesCart stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CannotAddProductsToExpiredCart stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14CannotCheckoutExpiredCart stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15AddingProductsRefreshesCart stamp: 'AF 11/20/2021 14:36:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'AF 11/20/2021 14:36:28'!
FAILURE!

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'AF 11/20/2021 14:36:28'!
FAILURE!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #CartTest #test02CartWithABookShouldNotBeEmpty stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #CartTest #test03CartIncludesBookAfterAdding stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #CartTest #test04CantAddBookNotIncludedInCatalog stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #CartTest #test05CartIncludesAllOccurrencesOfBookAfterAdding stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #CartTest #test06CantAddBookWithZeroQuantity stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #CartTest #test07CantAddBookWithNegativeQuantity stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #CheckoutTest #test01CannotCheckoutWithEmptyCart stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #CheckoutTest #test02CheckoutOfCartWithSingleItemReturnsReceiptOfItsPrice stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #CheckoutTest #test03CheckoutOfCartWithItemWithMultipleOcurrencesReturnsRecepitOfItsTotalPrice stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #CheckoutTest #test04CheckoutOfCartWithMultipleItemsReturnsReceiptWithASumOfTheirPrices stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #CheckoutTest #test05CannotCheckoutWithExpiredCard stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #CheckoutTest #test06CannotCheckoutWithInvalidNumberCard stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #CheckoutTest #test07CannotCheckoutWithCardWithoutFunds stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #CheckoutTest #test08CannotCheckoutWithStolenCard stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CannotCreateCartWithInvalidCredentials stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CartCreatedWithValidCredentialsIsEmpty stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03AddingMultipleOcurrencesOfAProductListsEachOne stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04AddingToACartDoesntAffectTheOthers stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CannotAddProductToCartWithInvalidId stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CannotListCartWithInvalidId stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07CannotCheckoutInvalidCartId stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CheckoutOfCartRegistersSales stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09CheckoutReturnsDifferentIdsEachTime stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CannotListExpiredCart stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CartsExpireOnlyAfterThirtyMinutes stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12ListingRefreshesCart stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CannotAddProductsToExpiredCart stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14CannotCheckoutExpiredCart stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15AddingProductsRefreshesCart stamp: 'AF 11/20/2021 14:36:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'AF 11/20/2021 14:36:49'!
FAILURE!

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'AF 11/20/2021 14:36:49'!
FAILURE!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #CartTest #test02CartWithABookShouldNotBeEmpty stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #CartTest #test03CartIncludesBookAfterAdding stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #CartTest #test04CantAddBookNotIncludedInCatalog stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #CartTest #test05CartIncludesAllOccurrencesOfBookAfterAdding stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #CartTest #test06CantAddBookWithZeroQuantity stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #CartTest #test07CantAddBookWithNegativeQuantity stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #CheckoutTest #test01CannotCheckoutWithEmptyCart stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #CheckoutTest #test02CheckoutOfCartWithSingleItemReturnsReceiptOfItsPrice stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #CheckoutTest #test03CheckoutOfCartWithItemWithMultipleOcurrencesReturnsRecepitOfItsTotalPrice stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #CheckoutTest #test04CheckoutOfCartWithMultipleItemsReturnsReceiptWithASumOfTheirPrices stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #CheckoutTest #test05CannotCheckoutWithExpiredCard stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #CheckoutTest #test06CannotCheckoutWithInvalidNumberCard stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #CheckoutTest #test07CannotCheckoutWithCardWithoutFunds stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #CheckoutTest #test08CannotCheckoutWithStolenCard stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CannotCreateCartWithInvalidCredentials stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CartCreatedWithValidCredentialsIsEmpty stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03AddingMultipleOcurrencesOfAProductListsEachOne stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04AddingToACartDoesntAffectTheOthers stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CannotAddProductToCartWithInvalidId stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CannotListCartWithInvalidId stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07CannotCheckoutInvalidCartId stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CheckoutOfCartRegistersSales stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09CheckoutReturnsDifferentIdsEachTime stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CannotListExpiredCart stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CartsExpireOnlyAfterThirtyMinutes stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12ListingRefreshesCart stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CannotAddProductsToExpiredCart stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14CannotCheckoutExpiredCart stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15AddingProductsRefreshesCart stamp: 'AF 11/20/2021 14:37:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'AF 11/20/2021 14:37:03'!
FAILURE!

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'AF 11/20/2021 14:37:03'!
FAILURE!

tusLibros catalog!

expectedCatalog!

expectedCatalog asString!

expectedCatalog!

testObjectFactory firstProductSoldByTheStore!

testObjectFactory firstProductSoldByTheStore!

tusLibros catalog!
!TusLibrosSystemFacadeTest methodsFor: 'tests' stamp: 'AF 11/20/2021 14:40:28' prior: 50983583!
test16

	| tusLibros expectedCatalog |

	tusLibros _ self defaultTusLibrosSystemFacade.

	expectedCatalog _ testObjectFactory defaultCatalog.
	
	self assert: expectedCatalog equals: tusLibros catalog.

! !

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'AF 11/20/2021 14:40:30'!
FAILURE!

testObjectFactory defaultCatalog keys!

 testObjectFactory defaultCatalog keys asOrderedCollection!

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'AF 11/20/2021 14:42:21'!
PASSED!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #CartTest #test02CartWithABookShouldNotBeEmpty stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #CartTest #test03CartIncludesBookAfterAdding stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #CartTest #test04CantAddBookNotIncludedInCatalog stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #CartTest #test05CartIncludesAllOccurrencesOfBookAfterAdding stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #CartTest #test06CantAddBookWithZeroQuantity stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #CartTest #test07CantAddBookWithNegativeQuantity stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #CheckoutTest #test01CannotCheckoutWithEmptyCart stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #CheckoutTest #test02CheckoutOfCartWithSingleItemReturnsReceiptOfItsPrice stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #CheckoutTest #test03CheckoutOfCartWithItemWithMultipleOcurrencesReturnsRecepitOfItsTotalPrice stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #CheckoutTest #test04CheckoutOfCartWithMultipleItemsReturnsReceiptWithASumOfTheirPrices stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #CheckoutTest #test05CannotCheckoutWithExpiredCard stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #CheckoutTest #test06CannotCheckoutWithInvalidNumberCard stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #CheckoutTest #test07CannotCheckoutWithCardWithoutFunds stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #CheckoutTest #test08CannotCheckoutWithStolenCard stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CannotCreateCartWithInvalidCredentials stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CartCreatedWithValidCredentialsIsEmpty stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03AddingMultipleOcurrencesOfAProductListsEachOne stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04AddingToACartDoesntAffectTheOthers stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CannotAddProductToCartWithInvalidId stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CannotListCartWithInvalidId stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07CannotCheckoutInvalidCartId stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CheckoutOfCartRegistersSales stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09CheckoutReturnsDifferentIdsEachTime stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CannotListExpiredCart stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CartsExpireOnlyAfterThirtyMinutes stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12ListingRefreshesCart stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CannotAddProductsToExpiredCart stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14CannotCheckoutExpiredCart stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15AddingProductsRefreshesCart stamp: 'AF 11/20/2021 14:42:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'AF 11/20/2021 14:42:24'!
FAILURE!

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'AF 11/20/2021 14:42:24'!
FAILURE!
!TusLibrosSystemFacadeTest methodsFor: 'tests' stamp: 'AF 11/20/2021 14:42:36' prior: 50985602!
test16

	| tusLibros expectedCatalog |

	tusLibros _ self defaultTusLibrosSystemFacade.

	expectedCatalog _ testObjectFactory defaultCatalog keys asOrderedCollection .
	
	self assert: expectedCatalog equals: tusLibros catalog.

! !

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'AF 11/20/2021 14:42:37'!
PASSED!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #CartTest #test02CartWithABookShouldNotBeEmpty stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #CartTest #test03CartIncludesBookAfterAdding stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #CartTest #test04CantAddBookNotIncludedInCatalog stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #CartTest #test05CartIncludesAllOccurrencesOfBookAfterAdding stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #CartTest #test06CantAddBookWithZeroQuantity stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #CartTest #test07CantAddBookWithNegativeQuantity stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #CheckoutTest #test01CannotCheckoutWithEmptyCart stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #CheckoutTest #test02CheckoutOfCartWithSingleItemReturnsReceiptOfItsPrice stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #CheckoutTest #test03CheckoutOfCartWithItemWithMultipleOcurrencesReturnsRecepitOfItsTotalPrice stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #CheckoutTest #test04CheckoutOfCartWithMultipleItemsReturnsReceiptWithASumOfTheirPrices stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #CheckoutTest #test05CannotCheckoutWithExpiredCard stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #CheckoutTest #test06CannotCheckoutWithInvalidNumberCard stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #CheckoutTest #test07CannotCheckoutWithCardWithoutFunds stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #CheckoutTest #test08CannotCheckoutWithStolenCard stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CannotCreateCartWithInvalidCredentials stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CartCreatedWithValidCredentialsIsEmpty stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03AddingMultipleOcurrencesOfAProductListsEachOne stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04AddingToACartDoesntAffectTheOthers stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CannotAddProductToCartWithInvalidId stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CannotListCartWithInvalidId stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07CannotCheckoutInvalidCartId stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CheckoutOfCartRegistersSales stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09CheckoutReturnsDifferentIdsEachTime stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CannotListExpiredCart stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CartsExpireOnlyAfterThirtyMinutes stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12ListingRefreshesCart stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CannotAddProductsToExpiredCart stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14CannotCheckoutExpiredCart stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15AddingProductsRefreshesCart stamp: 'AF 11/20/2021 14:42:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'AF 11/20/2021 14:42:40'!
PASSED!
!TusLibrosSystemFacadeTest methodsFor: 'tests' stamp: 'AF 11/20/2021 14:43:36' prior: 50985732!
test16

	| tusLibros expectedCatalog |

	tusLibros _ self defaultTusLibrosSystemFacade.

	expectedCatalog _ testObjectFactory defaultCatalog keys asOrderedCollection .
	
	self assert: tusLibros catalog includes: testObjectFactory firstProductSoldByTheStore.
	self assert: tusLibros catalog includes: testObjectFactory secondProductSoldByTheStore .

! !
!TusLibrosSystemFacadeTest methodsFor: 'tests' stamp: 'AF 11/20/2021 14:44:05' prior: 50985854!
test16

	| tusLibros expectedCatalog |

	tusLibros _ self defaultTusLibrosSystemFacade.

	expectedCatalog _ testObjectFactory defaultCatalog keys asOrderedCollection .
	
	self assert: tusLibros catalog includes: testObjectFactory firstProductSoldByTheStore.
	self assert: tusLibros catalog includes: testObjectFactory secondProductSoldByTheStore.
	self assert: tusLibros catalog size equals: 2.

! !
!TusLibrosSystemFacadeTest methodsFor: 'tests' stamp: 'AF 11/20/2021 14:44:21' prior: 50985869!
test16

	| tusLibros expectedCatalog |

	tusLibros _ self defaultTusLibrosSystemFacade.
	
	self assert: tusLibros catalog includes: testObjectFactory firstProductSoldByTheStore.
	self assert: tusLibros catalog includes: testObjectFactory secondProductSoldByTheStore.
	self assert: 2 equals:  tusLibros catalog size.

! !
!TusLibrosSystemFacadeTest methodsFor: 'tests' stamp: 'AF 11/20/2021 14:44:26' prior: 50985885!
test16

	| tusLibros |

	tusLibros _ self defaultTusLibrosSystemFacade.
	
	self assert: tusLibros catalog includes: testObjectFactory firstProductSoldByTheStore.
	self assert: tusLibros catalog includes: testObjectFactory secondProductSoldByTheStore.
	self assert: 2 equals: tusLibros catalog size.

! !

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'AF 11/20/2021 14:44:30'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CannotCreateCartWithInvalidCredentials stamp: 'AF 11/20/2021 14:44:30'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CartCreatedWithValidCredentialsIsEmpty stamp: 'AF 11/20/2021 14:44:30'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03AddingMultipleOcurrencesOfAProductListsEachOne stamp: 'AF 11/20/2021 14:44:30'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04AddingToACartDoesntAffectTheOthers stamp: 'AF 11/20/2021 14:44:30'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CannotAddProductToCartWithInvalidId stamp: 'AF 11/20/2021 14:44:30'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CannotListCartWithInvalidId stamp: 'AF 11/20/2021 14:44:30'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07CannotCheckoutInvalidCartId stamp: 'AF 11/20/2021 14:44:30'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CheckoutOfCartRegistersSales stamp: 'AF 11/20/2021 14:44:30'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09CheckoutReturnsDifferentIdsEachTime stamp: 'AF 11/20/2021 14:44:30'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CannotListExpiredCart stamp: 'AF 11/20/2021 14:44:30'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CartsExpireOnlyAfterThirtyMinutes stamp: 'AF 11/20/2021 14:44:30'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12ListingRefreshesCart stamp: 'AF 11/20/2021 14:44:30'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CannotAddProductsToExpiredCart stamp: 'AF 11/20/2021 14:44:30'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14CannotCheckoutExpiredCart stamp: 'AF 11/20/2021 14:44:30'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15AddingProductsRefreshesCart stamp: 'AF 11/20/2021 14:44:30'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'AF 11/20/2021 14:44:30'!
PASSED!
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 14:50:51' prior: 50985211!
handleAddProductToCart: request

	| cartId isbn quantity book |
	
	cartId _ (request fields at: 'cartId') asNumber.
	isbn _ request fields at: 'isbn'.
	quantity _ (request fields at: 'quantity') asNumber.
	
	book _ self findBookBy: isbn.	

	tusLibrosSystem add: quantity of: isbn to: cartId.

	request send200Response: 'OK'! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 14:51:17' prior: 50985973!
handleAddProductToCart: request

	| cartId isbn quantity book |
	
	cartId _ (request fields at: 'cartId') asNumber.
	isbn _ request fields at: 'isbn'.
	quantity _ (request fields at: 'quantity') asNumber.
	
	book _ self findBookBy: isbn.	

	tusLibrosSystem add: quantity of: book to: cartId.

	request send200Response: 'OK'! !

!classDefinition: #TusLibrosRestApiXXX category: 'TusLibros' stamp: 'AF 11/20/2021 14:56:13'!
Object subclass: #TusLibrosRestApiXXX
	instanceVariableNames: 'port webServer tusLibrosSystem booksByISBN'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 14:56:12'!
findBookBy: anISBN

	^ booksByISBN at: anISBN.! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:00:03' prior: 50986009!
findBookBy: anISBN
	
	
	^ booksByISBN at: anISBN ifAbsent: [self error: self class bookNotFoundErrorDescription ].! !
!TusLibrosRestApiXXX class methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:01:14'!
bookNotFoundErrorDescription
 
	^'ISBN dosent match any book'! !
!TusLibrosRestApiXXX class methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:02:18' prior: 50986021!
bookNotFoundErrorDescription
 
	^ 'book not found with recived ISBN'! !
!TusLibrosRestApiXXX class methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:02:22' prior: 50986027!
bookNotFoundErrorDescription
 
	^ 'book not found with that ISBN'! !
!TusLibrosRestApiXXX class methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:02:33' prior: 50986033!
bookNotFoundErrorDescription
 
	^ 'book with that ISBN not found '! !
!TusLibrosRestApiXXX class methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:02:38' prior: 50986039!
bookNotFoundErrorDescription
 
	^ 'book with that ISBN not found'! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:05:50' prior: 50984914!
initializeOn: aPortNumber
	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'haw' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	booksByISBN _ Dictionary new 
		at: self firstBookISBN put: self firstBook.
	
	webServer addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self addService: '/catalog' 
		withErrorSafeAction: [ :request | self handleCatalog: request ].
	
	self addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].

	self addService: '/listPurchases'
		withErrorSafeAction: [ :request | self handleListPurchases: request ].

	self addService: '/checkout'
		withErrorSafeAction: [ :request | self handleCheckout: request. ].
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:06:22' prior: 50986051!
initializeOn: aPortNumber
	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'haw' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: testObjectFactory defaultCatalog 
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	booksByISBN _ Dictionary new 
		at: self firstBookISBN put: self firstBook;
		at: self secondBookISBN put: self secondBook;
		yourself.
	
	webServer addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self addService: '/catalog' 
		withErrorSafeAction: [ :request | self handleCatalog: request ].
	
	self addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].

	self addService: '/listPurchases'
		withErrorSafeAction: [ :request | self handleListPurchases: request ].

	self addService: '/checkout'
		withErrorSafeAction: [ :request | self handleCheckout: request. ].
		
	! !

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #CartTest #test02CartWithABookShouldNotBeEmpty stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #CartTest #test03CartIncludesBookAfterAdding stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #CartTest #test04CantAddBookNotIncludedInCatalog stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #CartTest #test05CartIncludesAllOccurrencesOfBookAfterAdding stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #CartTest #test06CantAddBookWithZeroQuantity stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #CartTest #test07CantAddBookWithNegativeQuantity stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #CheckoutTest #test01CannotCheckoutWithEmptyCart stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #CheckoutTest #test02CheckoutOfCartWithSingleItemReturnsReceiptOfItsPrice stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #CheckoutTest #test03CheckoutOfCartWithItemWithMultipleOcurrencesReturnsRecepitOfItsTotalPrice stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #CheckoutTest #test04CheckoutOfCartWithMultipleItemsReturnsReceiptWithASumOfTheirPrices stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #CheckoutTest #test05CannotCheckoutWithExpiredCard stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #CheckoutTest #test06CannotCheckoutWithInvalidNumberCard stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #CheckoutTest #test07CannotCheckoutWithCardWithoutFunds stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #CheckoutTest #test08CannotCheckoutWithStolenCard stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CannotCreateCartWithInvalidCredentials stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CartCreatedWithValidCredentialsIsEmpty stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03AddingMultipleOcurrencesOfAProductListsEachOne stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04AddingToACartDoesntAffectTheOthers stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CannotAddProductToCartWithInvalidId stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CannotListCartWithInvalidId stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07CannotCheckoutInvalidCartId stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CheckoutOfCartRegistersSales stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09CheckoutReturnsDifferentIdsEachTime stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CannotListExpiredCart stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CartsExpireOnlyAfterThirtyMinutes stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12ListingRefreshesCart stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CannotAddProductsToExpiredCart stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14CannotCheckoutExpiredCart stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15AddingProductsRefreshesCart stamp: 'AF 11/20/2021 15:06:31'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16 stamp: 'AF 11/20/2021 15:06:31'!
PASSED!
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:06:58'!
firstBookISBN

	^'123'! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:07:05' prior: 50986251!
firstBookISBN

	^'1'! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:08:12' prior: 50986256!
firstBookISBN

	^'9780262033848'! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:09:00' prior: 50986260!
firstBookISBN

	^'9780262033848'! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:09:13'!
firstBook

	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:09:54' prior: 50986269!
firstBook

	^ Book titled: 'Introduction to Algorithms, 3rd Edition' isbn: nil! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:10:04' prior: 50986273!
firstBook

	^ Book titled: 'Introduction to Algorithms, 3rd Edition' isbn: '9780262033848'! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:10:21' prior: 50986279!
firstBook

	^ Book titled: 'Introduction to Algorithms, 3rd Edition' isbn: self firstBookISBN ! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:10:23' prior: 50986286!
firstBook

	^ Book titled: 'Introduction to Algorithms, 3rd Edition' isbn: self firstBookISBN.! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:10:37'!
secondBookISBN

	^ Book titled: 'Introduction to Algorithms, 3rd Edition' isbn: self firstBookISBN.! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:11:26' prior: 50986299!
secondBookISBN

	^ nil! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:13:07' prior: 50986306!
secondBookISBN

	^ '8420412147'.! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:13:39'!
secondBook

	^ Book titled: 'Don Quijote de la Mancha' isbn: self secondBookISBN .! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:13:41' prior: 50986315!
secondBook

	^ Book titled: 'Don Quijote de la Mancha' isbn: self secondBookISBN.! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:16:42' prior: 50986096!
initializeOn: aPortNumber
	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'haw' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: self catalog
		chargingThrough: self SimulatedMP 
		withClock: SystemClock new. 
	
	booksByISBN _ Dictionary new 
		at: self firstBookISBN put: self firstBook;
		at: self secondBookISBN put: self secondBook;
		yourself.
	
	webServer addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self addService: '/catalog' 
		withErrorSafeAction: [ :request | self handleCatalog: request ].
	
	self addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].

	self addService: '/listPurchases'
		withErrorSafeAction: [ :request | self handleListPurchases: request ].

	self addService: '/checkout'
		withErrorSafeAction: [ :request | self handleCheckout: request. ].
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:16:50' prior: 50986327!
initializeOn: aPortNumber
	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'haw' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: self catalog
		chargingThrough: testObjectFactory defaultSimulatedMP 
		withClock: SystemClock new. 
	
	booksByISBN _ Dictionary new 
		at: self firstBookISBN put: self firstBook;
		at: self secondBookISBN put: self secondBook;
		yourself.
	
	webServer addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self addService: '/catalog' 
		withErrorSafeAction: [ :request | self handleCatalog: request ].
	
	self addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].

	self addService: '/listPurchases'
		withErrorSafeAction: [ :request | self handleListPurchases: request ].

	self addService: '/checkout'
		withErrorSafeAction: [ :request | self handleCheckout: request. ].
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:18:36'!
catalog

	^ nil! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:20:18' prior: 50986417!
catalog

	^ Dictionary new
		at: self firstBook put: 119;
		at: self secondBook put: 999;
		yourself.! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:22:38' prior: 50986372!
initializeOn: aPortNumber
	| testObjectFactory authenticationSystem |
	
	testObjectFactory _ TestObjectFactory new.
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'haw' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: self catalog
		chargingThrough: self defaultSimulatedMP 
		withClock: SystemClock new. 
	
	booksByISBN _ Dictionary new 
		at: self firstBookISBN put: self firstBook;
		at: self secondBookISBN put: self secondBook;
		yourself.
	
	webServer addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self addService: '/catalog' 
		withErrorSafeAction: [ :request | self handleCatalog: request ].
	
	self addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].

	self addService: '/listPurchases'
		withErrorSafeAction: [ :request | self handleListPurchases: request ].

	self addService: '/checkout'
		withErrorSafeAction: [ :request | self handleCheckout: request. ].
		
	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:24:13'!
defaultSimulatedMP

	^ nil! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:28:12' prior: 50986473!
defaultSimulatedMP

	^ SimulatedMP
		withNoFundsCard: self cardWithoutFundsNumber
		stolenCard: self stolenCardNumber.! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:28:30'!
cardWithoutFundsNumber
	
	^ '4509790000006789'! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:29:22'!
stolenCardNumber
	
	^ '4509790000000000'! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:30:09' prior: 50986478!
defaultSimulatedMP

	^ SimulatedMP
		withNoFundsCard: self cardWithoutFundsNumber
		stolenCard: self stolenCardNumber.! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:30:47' prior: 50986428!
initializeOn: aPortNumber
	| authenticationSystem |
	
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'haw' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: self catalog
		chargingThrough: self defaultSimulatedMP 
		withClock: SystemClock new. 
	
	booksByISBN _ Dictionary new 
		at: self firstBookISBN put: self firstBook;
		at: self secondBookISBN put: self secondBook;
		yourself.
	
	webServer addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self addService: '/catalog' 
		withErrorSafeAction: [ :request | self handleCatalog: request ].
	
	self addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].

	self addService: '/listPurchases'
		withErrorSafeAction: [ :request | self handleListPurchases: request ].

	self addService: '/checkout'
		withErrorSafeAction: [ :request | self handleCheckout: request. ].
		
	! !

TusLibrosLoginWindow open.!
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:32:12'!
simulatedMP

	^ SimulatedMP
		withNoFundsCard: self cardWithoutFundsNumber
		stolenCard: self stolenCardNumber.! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:32:12' prior: 50986503!
initializeOn: aPortNumber
	| authenticationSystem |
	
	webServer _ WebServer new listenOn: aPortNumber.
	authenticationSystem _ ConfigurableAuthenticationSystem new 
		register: 'haw' authenticatedBy: 'hunter2'.
	
	tusLibrosSystem _ TusLibrosSystemFacade 
		authenticatingWith: authenticationSystem
		sourcingProductsFrom: self catalog
		chargingThrough: self simulatedMP 
		withClock: SystemClock new. 
	
	booksByISBN _ Dictionary new 
		at: self firstBookISBN put: self firstBook;
		at: self secondBookISBN put: self secondBook;
		yourself.
	
	webServer addService: '/ping'
		action: [ :request |	 self handlePing: request ].
	
	self addService: '/catalog' 
		withErrorSafeAction: [ :request | self handleCatalog: request ].
	
	self addService: '/createCart' 
		withErrorSafeAction: [ :request | self handleCreateCart: request ].
	
	self addService: '/addProductToCart'
		withErrorSafeAction: [ :request | self handleAddProductToCart: request ].
		
	self addService: '/listCart'
		withErrorSafeAction: [ :request | self handleListCart: request ].

	self addService: '/listPurchases'
		withErrorSafeAction: [ :request | self handleListPurchases: request ].

	self addService: '/checkout'
		withErrorSafeAction: [ :request | self handleCheckout: request. ].
		
	! !

!methodRemoval: TusLibrosRestApiXXX #defaultSimulatedMP stamp: 'AF 11/20/2021 15:32:12'!
defaultSimulatedMP

	^ SimulatedMP
		withNoFundsCard: self cardWithoutFundsNumber
		stolenCard: self stolenCardNumber.!

TusLibrosRestApiXXX cleanUpAndListenOn: 8080. a TusLibrosRestApiXXX !

TusLibrosRestApiXXX cleanUpAndListenOn: 8080!

TusLibrosLoginWindow open.!
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:36:00' prior: 50982931!
buildMorphicWindow
	
	| addToCartButtonMorph catalogAndButtonColumnLayoutMorph catalogMorph listPurchasesButtonMorph viewCartButtonMorph |

	catalogMorph := PluggableListMorph 
		model: self model 
		listGetter: #catalog
		indexGetter: #catalogIndex
		indexSetter: #catalogIndex:.

	addToCartButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #addToCart
		label: 'Add to cart'.
	
	catalogAndButtonColumnLayoutMorph _ LayoutMorph newColumn
		addMorph: catalogMorph;
		addMorph: addToCartButtonMorph;
		axisEdgeWeight: 0.5;
		yourself.
	
	catalogMorph := PluggableListMorph 
		model: self model 
		listGetter: #catalog
		indexGetter: #catalogIndex
		indexSetter: #catalogIndex:.

	addToCartButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #addToCart
		label: 'Add to cart'.
	
	catalogAndButtonColumnLayoutMorph _ LayoutMorph newColumn
		addMorph: catalogMorph;
		addMorph: addToCartButtonMorph;
		axisEdgeWeight: 0.5;
		yourself.
		
		

	listPurchasesButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #listPurchases
		label: 'List purchases'.

	self layoutMorph
		beRow;
		separation: 15;
		axisEdgeWeight: 0;
		addMorph: catalogAndButtonColumnLayoutMorph;
		addMorph: viewCartButtonMorph;
		addMorph: listPurchasesButtonMorph.! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:36:59' prior: 50986609!
buildMorphicWindow
	
	| addToCartButtonMorph catalogAndButtonColumnLayoutMorph catalogMorph listPurchasesButtonMorph viewCartButtonMorph |


	
	catalogAndButtonColumnLayoutMorph _ self buildCatalogColumn.
	
	catalogMorph := PluggableListMorph 
		model: self model 
		listGetter: #catalog
		indexGetter: #catalogIndex
		indexSetter: #catalogIndex:.

	addToCartButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #addToCart
		label: 'Add to cart'.
	
	catalogAndButtonColumnLayoutMorph _ LayoutMorph newColumn
		addMorph: catalogMorph;
		addMorph: addToCartButtonMorph;
		axisEdgeWeight: 0.5;
		yourself.
		
		

	listPurchasesButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #listPurchases
		label: 'List purchases'.

	self layoutMorph
		beRow;
		separation: 15;
		axisEdgeWeight: 0;
		addMorph: catalogAndButtonColumnLayoutMorph;
		addMorph: viewCartButtonMorph;
		addMorph: listPurchasesButtonMorph.! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:37:10' prior: 50986655!
buildMorphicWindow
	
	| addToCartButtonMorph catalogAndButtonColumnLayoutMorph catalogMorph listPurchasesButtonMorph viewCartButtonMorph |

	catalogAndButtonColumnLayoutMorph _ self buildCatalogColumn.
	
	catalogMorph := PluggableListMorph 
		model: self model 
		listGetter: #catalog
		indexGetter: #catalogIndex
		indexSetter: #catalogIndex:.

	addToCartButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #addToCart
		label: 'Add to cart'.
	
	catalogAndButtonColumnLayoutMorph _ LayoutMorph newColumn
		addMorph: catalogMorph;
		addMorph: addToCartButtonMorph;
		axisEdgeWeight: 0.5;
		yourself.
		
		

	listPurchasesButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #listPurchases
		label: 'List purchases'.

	self layoutMorph
		beRow;
		separation: 15;
		axisEdgeWeight: 0;
		addMorph: catalogAndButtonColumnLayoutMorph;
		addMorph: viewCartButtonMorph;
		addMorph: listPurchasesButtonMorph.! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:38:19'!
buildCatalogColumn
	
	| addToCartButtonMorph catalogMorph |
	catalogMorph := PluggableListMorph 
		model: self model 
		listGetter: #catalog
		indexGetter: #catalogIndex
		indexSetter: #catalogIndex:.

	addToCartButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #addToCart
		label: 'Add to cart'.
	
	^ LayoutMorph newColumn
		addMorph: catalogMorph;
		addMorph: addToCartButtonMorph;
		axisEdgeWeight: 0.5;
		yourself.
		
! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:38:34'!
buildCartColumn
	
	| addToCartButtonMorph catalogMorph |
	catalogMorph := PluggableListMorph 
		model: self model 
		listGetter: #catalog
		indexGetter: #catalogIndex
		indexSetter: #catalogIndex:.

	addToCartButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #addToCart
		label: 'Add to cart'.
	
	^ LayoutMorph newColumn
		addMorph: catalogMorph;
		addMorph: addToCartButtonMorph;
		axisEdgeWeight: 0.5;
		yourself.
		
! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:39:58' prior: 50986741!
buildCartColumn
	
	| addToCartButtonMorph catalogMorph |
	catalogMorph := PluggableListMorph 
		model: self model 
		listGetter: #cart
		indexGetter: #cartIndex
		indexSetter: #cartIndex:.

	addToCartButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #removeFromCart
		label: 'Add to cart'.
	
	^ LayoutMorph newColumn
		addMorph: catalogMorph;
		addMorph: addToCartButtonMorph;
		axisEdgeWeight: 0.5;
		yourself.
		
! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:40:58' prior: 50986689!
buildMorphicWindow
	
	| catalogAndButtonColumnLayoutMorph listPurchasesButtonMorph viewCartButtonMorph |

	catalogAndButtonColumnLayoutMorph _ self buildCatalogColumn.

	listPurchasesButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #listPurchases
		label: 'List purchases'.

	self layoutMorph
		beRow;
		separation: 15;
		axisEdgeWeight: 0;
		addMorph: catalogAndButtonColumnLayoutMorph;
		addMorph: viewCartButtonMorph;
		addMorph: listPurchasesButtonMorph.! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:42:12' prior: 50986777!
buildMorphicWindow
	
	| listPurchasesButtonMorph |

	
	
	listPurchasesButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #listPurchases
		label: 'List purchases'.

	self layoutMorph
		beRow;
		separation: 15;
		axisEdgeWeight: 0;
		addMorph: self buildCatalogColumn;
		addMorph: self buildCartColumn;
		addMorph: listPurchasesButtonMorph.! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:49:56' prior: 50986759!
buildCartColumn
	
	| addToCartButtonMorph catalogMorph |
	catalogMorph := PluggableListMorph 
		model: self model 
		listGetter: #cartProducts
		indexGetter: #cartIndex
		indexSetter: #cartIndex:.

	addToCartButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #removeFromCart
		label: 'Add to cart'.
	
	^ LayoutMorph newColumn
		addMorph: catalogMorph;
		addMorph: addToCartButtonMorph;
		axisEdgeWeight: 0.5;
		yourself.
		
! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:51:28'!
cartProducts
	
	^self listCartRequest.! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:52:26' prior: 50984718!
catalogRequest

	| resp |

	resp _ WebClient httpGet: (self url, '/listCart').

	resp isSuccess 
		ifTrue: [^ (TusLibrosEncoder decodeCatalog: resp content readStream) asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'MP 11/19/2021 01:35:43' prior: 50986836!
catalogRequest

	| resp |

	resp _ WebClient httpGet: (self url, '/catalog').

	resp isSuccess 
		ifTrue: [^ (TusLibrosEncoder decodeCatalog: resp content readStream) asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:53:16'!
listCartRequest

	| resp |

	resp _ WebClient httpGet: (self url, '/listCart').

	resp isSuccess 
		ifTrue: [^ (TusLibrosEncoder decodeCatalog: resp content readStream) asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !
!TusLibrosEncoder class methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:55:02' prior: 50984584!
decodeCatalog: anEncodedBookCollection

	| decodedCatalog |
	decodedCatalog _ WebUtils jsonDecode: anEncodedBookCollection.
	^ decodedCatalog collect: [ :anEncodedBook | self decodeBook: anEncodedBook ].
	

	! !
!TusLibrosEncoder class methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:55:06'!
decodeBookCollection: anEncodedBookCollection

	| decodedCatalog |
	decodedCatalog _ WebUtils jsonDecode: anEncodedBookCollection.
	^ decodedCatalog collect: [ :anEncodedBook | self decodeBook: anEncodedBook ].
	

	! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:55:06' prior: 50986847!
catalogRequest

	| resp |

	resp _ WebClient httpGet: (self url, '/catalog').

	resp isSuccess 
		ifTrue: [^ (TusLibrosEncoder decodeBookCollection: resp content readStream) asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:55:06' prior: 50986858!
listCartRequest

	| resp |

	resp _ WebClient httpGet: (self url, '/listCart').

	resp isSuccess 
		ifTrue: [^ (TusLibrosEncoder decodeBookCollection: resp content readStream) asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !

!methodRemoval: TusLibrosEncoder class #decodeCatalog: stamp: 'AF 11/20/2021 15:55:06'!
decodeCatalog: anEncodedBookCollection

	| decodedCatalog |
	decodedCatalog _ WebUtils jsonDecode: anEncodedBookCollection.
	^ decodedCatalog collect: [ :anEncodedBook | self decodeBook: anEncodedBook ].
	

	!
!TusLibrosEncoder class methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:56:17'!
encodeBookCollection: aCatalog

	| catalogWithEncodedBooks |
	catalogWithEncodedBooks _ 
		aCatalog collect: [ :aBook | self encodeBook: aBook ].
	
	^ WebUtils jsonEncode: catalogWithEncodedBooks asArray.

	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:56:17' prior: 50984877!
handleCatalog: request

	| catalog |
	catalog _ tusLibrosSystem catalog.

	request send200Response: (TusLibrosEncoder encodeBookCollection: catalog)! !

!methodRemoval: TusLibrosEncoder class #encodeCatalog: stamp: 'AF 11/20/2021 15:56:17'!
encodeCatalog: aCatalog

	| catalogWithEncodedBooks |
	catalogWithEncodedBooks _ 
		aCatalog collect: [ :aBook | self encodeBook: aBook ].
	
	^ WebUtils jsonEncode: catalogWithEncodedBooks asArray.

	!
!TusLibrosEncoder class methodsFor: 'nil' stamp: 'AF 11/20/2021 15:56:17'!
encodeCatalog: aBookCollection

	| catalogWithEncodedBooks |
	catalogWithEncodedBooks _ 
		aBookCollection collect: [ :aBook | self encodeBook: aBook ].
	
	^ WebUtils jsonEncode: catalogWithEncodedBooks asArray.

	! !
!TusLibrosEncoder class methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:57:33' prior: 50986921!
encodeBookCollection: aBookCollection

	| catalogWithEncodedBooks |
	catalogWithEncodedBooks _ 
		aBookCollection collect: [ :aBook | self encodeBook: aBook ].
	
	^ WebUtils jsonEncode: catalogWithEncodedBooks asArray.

	! !
!TusLibrosRestApiXXX methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 15:59:30' prior: 50976487!
handleListCart: request

	| cartId cartContents |
				
	cartId _ (request fields at: 'cartId') asNumber.
	
	request send200Response: (TusLibrosEncoder encodeBookCollection: (tusLibrosSystem listCart: cartId)). ! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:03:17' prior: 50985190!
addToCart
	
	| selectedBookIsbn |
	
	selectedBookIsbn _ (catalog at: catalogIndex) isbn.
	self addToCartRequest: selectedBookIsbn.
	self triggerEvent: nil.! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:04:56' prior: 50982753!
initializeWithModel: aTusLibrosClientModel title: aTitle

	self setLabel: aTitle.
	self model: aTusLibrosClientModel.
	self buildMorphicWindow.
	
	self model when: #bookAddedToCart send: #refreshCartList to: self.
	
	self openInWorld.! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:05:24' prior: 50986813!
buildCartColumn
	
	| addToCartButtonMorph catalogMorph |
	catalogMorph := PluggableListMorph 
		model: self model 
		listGetter: #cart
		indexGetter: #cartIndex
		indexSetter: #cartIndex:.

	addToCartButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #removeFromCart
		label: 'Add to cart'.
	
	^ LayoutMorph newColumn
		addMorph: catalogMorph;
		addMorph: addToCartButtonMorph;
		axisEdgeWeight: 0.5;
		yourself.
		
! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:05:31' prior: 50986989!
initializeWithModel: aTusLibrosClientModel title: aTitle

	self setLabel: aTitle.
	self model: aTusLibrosClientModel.
	self buildMorphicWindow.
	
	self model when: #bookAddedToCart send: #refreshCart to: self.
	
	self openInWorld.! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:05:51'!
refreshCart
	
	! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:06:27' prior: 50987029!
refreshCart
	
	nil updateList.
	nil setSelectionIndex: 0.! !

!classDefinition: #TusLibrosClientMainWindow category: 'TusLibros' stamp: 'AF 11/20/2021 16:07:21'!
SystemWindow subclass: #TusLibrosClientMainWindow
	instanceVariableNames: 'cartMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:07:20' prior: 50987000!
buildCartColumn
	
	| addToCartButtonMorph catalogMorph |
	cartMorph := PluggableListMorph 
		model: self model 
		listGetter: #cart
		indexGetter: #cartIndex
		indexSetter: #cartIndex:.

	addToCartButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #removeFromCart
		label: 'Add to cart'.
	
	^ LayoutMorph newColumn
		addMorph: catalogMorph;
		addMorph: addToCartButtonMorph;
		axisEdgeWeight: 0.5;
		yourself.
		
! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:07:29' prior: 50987048!
buildCartColumn
	
	| addToCartButtonMorph |
	cartMorph := PluggableListMorph 
		model: self model 
		listGetter: #cart
		indexGetter: #cartIndex
		indexSetter: #cartIndex:.

	addToCartButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #removeFromCart
		label: 'Add to cart'.
	
	^ LayoutMorph newColumn
		addMorph: cartMorph;
		addMorph: addToCartButtonMorph;
		axisEdgeWeight: 0.5;
		yourself.
		
! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:07:57' prior: 50987034!
refreshCart
	
	cartMorph updateList.
	cartMorph setSelectionIndex: 1.! !

TusLibrosRestApiXXX cleanUpAndListenOn: 8080!

TusLibrosLoginWindow open.!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:09:23'!
cart
	
	^self listCartRequest.! !

!methodRemoval: TusLibrosClientModel #cartProducts stamp: 'AF 11/20/2021 16:09:34'!
cartProducts
	
	^self listCartRequest.!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:10:00' prior: 50987092!
cart
	
	^self listCartRequest.! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:10:11'!
cartProducts
	
	^self listCartRequest.! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:10:11' prior: 50987066!
buildCartColumn
	
	| addToCartButtonMorph |
	cartMorph := PluggableListMorph 
		model: self model 
		listGetter: #cartProducts
		indexGetter: #cartIndex
		indexSetter: #cartIndex:.

	addToCartButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #removeFromCart
		label: 'Add to cart'.
	
	^ LayoutMorph newColumn
		addMorph: cartMorph;
		addMorph: addToCartButtonMorph;
		axisEdgeWeight: 0.5;
		yourself.
		
! !

!methodRemoval: TusLibrosClientModel #cart stamp: 'AF 11/20/2021 16:10:11'!
cart
	
	^self listCartRequest.!
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:10:21' prior: 50987110!
buildCartColumn
	
	| addToCartButtonMorph |
	cartMorph := PluggableListMorph 
		model: self model 
		listGetter: #cartProducts
		indexGetter: #cartIndex
		indexSetter: #cartIndex:.

	addToCartButtonMorph _ PluggableButtonMorph 
		model: self model
		stateGetter: nil 
		action: #removeFromCart
		label: 'Add to cart'.
	
	^ LayoutMorph newColumn
		addMorph: cartMorph;
		addMorph: addToCartButtonMorph;
		axisEdgeWeight: 0.5;
		yourself.
		
! !

TusLibrosLoginWindow open.!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:12:44' prior: 50986901!
listCartRequest

	| resp fields |

	fields _ Dictionary new 
		at: 'cartId' put: cartId;
		yourself.
	resp _ WebClient httpGet: (self url, '/listCart') .

	resp isSuccess 
		ifTrue: [^ (TusLibrosEncoder decodeBookCollection: resp content readStream) asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:13:08' prior: 50987150!
listCartRequest

	| resp fields |

	fields _ Dictionary new 
		at: 'cartId' put: cartId;
		yourself.
	resp _ WebClient httpGet: (self url, '/listCart') "fields: fields" .

	resp isSuccess 
		ifTrue: [^ (TusLibrosEncoder decodeBookCollection: resp content readStream) asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !

WebClient!

WebClient!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:18:02' prior: 50987164!
listCartRequest

	| resp fields |

	
	resp _ WebClient 
		htmlSubmit: self url, '/listCart' 
		fields: { 'cartId' -> cartId }
		method: 'GET'.

	resp isSuccess 
		ifTrue: [^ (TusLibrosEncoder decodeBookCollection: resp content readStream) asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:18:11' prior: 50987179!
listCartRequest

	| resp |

	
	resp _ WebClient 
		htmlSubmit: self url, '/listCart' 
		fields: { 'cartId' -> cartId }
		method: 'GET'.

	resp isSuccess 
		ifTrue: [^ (TusLibrosEncoder decodeBookCollection: resp content readStream) asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:18:18' prior: 50987192!
listCartRequest

	| resp |

	resp _ WebClient 
		htmlSubmit: self url, '/listCart' 
		fields: { 'cartId' -> cartId }
		method: 'GET'.

	resp isSuccess 
		ifTrue: [^ (TusLibrosEncoder decodeBookCollection: resp content readStream) asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:18:33' prior: 50986890!
catalogRequest

	| resp |

	resp _ WebClient httpGet: self url, '/catalog'.

	resp isSuccess 
		ifTrue: [^ (TusLibrosEncoder decodeBookCollection: resp content readStream) asOrderedCollection ] 
		ifFalse:[ ^ self error: resp content ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:20:14' prior: 50985224!
addToCartRequest: aIsbn
	
	| resp fields |

	fields _ Dictionary new 
		at: 'cartId' put: cartId;
		at: 'isbn' put: aIsbn ;
		at: 'quantity' put: '1';
		yourself.
	
	resp _ WebClient 
		htmlSubmit: self url, '/addProductToCart' 
		fields: {
		'cartId' -> cartId.
		'isbn' -> aIsbn.
		'quantity' -> '1'.
		} method: 'POST'.
	
	resp isSuccess 
		ifTrue: [^ self ] 
		ifFalse:[ ^ self handleErrorResponse: resp ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:20:25' prior: 50987229!
addToCartRequest: aIsbn
	
	| resp fields |

	fields _ Dictionary new 
		at: 'cartId' put: cartId;
		at: 'isbn' put: aIsbn ;
		at: 'quantity' put: '1';
		yourself.
	
	resp _ WebClient 
		htmlSubmit: self url, '/addProductToCart' 
		fields: {
			'cartId' -> cartId.
			'isbn' -> aIsbn.
			'quantity' -> '1'.
		} method: 'POST'.
	
	resp isSuccess 
		ifTrue: [^ self ] 
		ifFalse:[ ^ self handleErrorResponse: resp ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:20:33' prior: 50987246!
addToCartRequest: aIsbn
	
	| resp |
	
	resp _ WebClient 
		htmlSubmit: self url, '/addProductToCart' 
		fields: {
			'cartId' -> cartId.
			'isbn' -> aIsbn.
			'quantity' -> '1'.
		} method: 'POST'.
	
	resp isSuccess 
		ifTrue: [^ self ] 
		ifFalse:[ ^ self handleErrorResponse: resp ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:20:44' prior: 50987263!
addToCartRequest: aIsbn
	
	| resp |
	
	resp _ WebClient 
		htmlSubmit: self url, '/addProductToCart' 
		fields: {
			'cartId' -> cartId.
			'isbn' -> aIsbn.
			'quantity' -> '1'
		} method: 'POST'.
	
	resp isSuccess 
		ifTrue: [^ self ] 
		ifFalse:[ ^ self handleErrorResponse: resp ].! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:20:49' prior: 50987276!
addToCartRequest: aIsbn
	
	| resp |
	
	resp _ WebClient 
		htmlSubmit: self url, '/addProductToCart' 
		fields: {
			'cartId' -> cartId.
			'isbn' -> aIsbn.
			'quantity' -> '1'.
		} method: 'POST'.
	
	resp isSuccess 
		ifTrue: [^ self ] 
		ifFalse:[ ^ self handleErrorResponse: resp ].! !

!classDefinition: #TusLibrosClientModel category: 'TusLibros' stamp: 'AF 11/20/2021 16:21:48'!
Object subclass: #TusLibrosClientModel
	instanceVariableNames: 'username password cartId catalogIndex catalog cartIndex'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:21:46'!
cartIndex

 	^cartIndex.! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:22:04'!
cartIndex: aCartIndex

 	cartIndex _ aCartIndex.! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:23:14' prior: 50985051 overrides: 16896425!
initialize

	username _ 'haw'.
	password _ 'hunter2'.
	catalogIndex _ 1.
	cartIndex _ 1.! !

TusLibrosLoginWindow open.!
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:24:19' prior: 50986980!
addToCart
	
	| selectedBookIsbn |
	
	selectedBookIsbn _ (catalog at: catalogIndex) isbn.
	self addToCartRequest: selectedBookIsbn.
	self triggerEvent: #productAddedToCart.! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:24:26' prior: 50987328!
addToCart
	
	| selectedBookIsbn |
	
	selectedBookIsbn _ (catalog at: catalogIndex) isbn.
	self addToCartRequest: selectedBookIsbn.
	self triggerEvent: #bookAddedToCart.! !
!TusLibrosClientModel methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:27:23' prior: 50987105!
cartProducts
	
	| cartProducts |
	cartProducts _ self listCartRequest.
	^cartProducts collect: [ :aBook | 	'(ISBN #', aBook isbn, ') ', aBook title ].! !

TusLibrosLoginWindow open.!
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:28:26' prior: 50987084!
refreshCart
	
	cartMorph updateList.
	cartMorph setSelectionIndex: 1.! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:30:02' prior: 50987356!
refreshCart
	
	cartMorph updateList.
	cartMorph setSelectionIndex: cartMorph maximumSelection .! !
!TusLibrosClientMainWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/20/2021 16:30:10' prior: 50987362!
refreshCart
	
	cartMorph updateList.
	cartMorph setSelectionIndex: cartMorph maximumSelection.! !

TusLibrosLoginWindow open.!

TusLibrosLoginWindow open.!

----QUIT----(20 November 2021 16:36:28) CuisUniversity-4972.image priorSource: 20912975!
>>>>>>> 20/it4: agrego morph del carrito en la vantana principal
